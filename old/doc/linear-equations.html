<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Equations in two unknowns</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>This vignette illustrates the ideas behind solving systems of linear equations of the form \(\mathbf{A x = b}\)
where </p>

<ul>
<li>\(\mathbf{A}\) is an \(m \times n\) matrix of coefficients for \(m\) equations in \(n\) unknowns</li>
<li>\(\mathbf{x}\) is an \(n \times 1\) vector unknowns, \(x_1, x_2, \dots x_n\)</li>
<li>\(\mathbf{b}\) is an \(m \times 1\) vector of constants, the &ldquo;right-hand sides&rdquo; of the equations</li>
</ul>

<p>The general conditions for solutions are:</p>

<ul>
<li>the equations are <em>consistent</em> (solutions exist) if \(r( \mathbf{A} | \mathbf{b}) = r( \mathbf{A})\)

<ul>
<li>the solution is <em>unique</em> if \(r( \mathbf{A} | \mathbf{b}) = r( \mathbf{A}) = n\)</li>
<li>the solution is <em>underdetermined</em> if \(r( \mathbf{A} | \mathbf{b}) = r( \mathbf{A}) < n\)</li>
</ul></li>
<li>the equations are <em>inconsistent</em> (no solutions) if \(r( \mathbf{A} | \mathbf{b}) = r( \mathbf{A})\)</li>
</ul>

<p>We use <code>c( R(A), R(cbind(A,b)) )</code> to show the ranks, and <code>all.equal( R(A), R(cbind(A,b)) )</code> to test
for consistency.</p>

<pre><code class="r">library(matlib)   # use the package
</code></pre>

<h2>Equations in two unknowns</h2>

<p>Each equation in two unknowns corresponds to a line in 2D space. The equations
have a unique solution if all lines intersect in a point.</p>

<h3>Two consistent equations</h3>

<pre><code class="r">A &lt;- matrix(c(1, 2, -1, 2), 2, 2)
b &lt;- c(2,1)
showEqn(A, b)
</code></pre>

<pre><code>##      [,1]               
## [1,] &quot;1*x1 - 1*x2  =  2&quot;
## [2,] &quot;2*x1 + 2*x2  =  1&quot;
</code></pre>

<pre><code class="r">c( R(A), R(cbind(A,b)) )          # show ranks
</code></pre>

<pre><code>## [1] 2 2
</code></pre>

<pre><code class="r">all.equal( R(A), R(cbind(A,b)) )  # consistent?
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<p>Plot them:</p>

<pre><code class="r">plotEqn(A,b)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/> </p>

<h3>Three consistent equations</h3>

<p>For three (or more) equations in two unknowns, \(r(\mathbf{A}) \le 2\), because  \(r(\mathbf{A}) \le \min(m,n)\).
The equations will be consistent
if \(r(\mathbf{A}) = r(\mathbf{A | b})\), which means that whatever linear relations
exist among the rows of \(\mathbf{A}\) are the same as those among the elements of \(\mathbf{b}\).</p>

<pre><code class="r">A &lt;- matrix(c(1,2,3, -1, 2, 1), 3, 2)
b &lt;- c(2,1,3)
showEqn(A, b)
</code></pre>

<pre><code>##      [,1]               
## [1,] &quot;1*x1 - 1*x2  =  2&quot;
## [2,] &quot;2*x1 + 2*x2  =  1&quot;
## [3,] &quot;3*x1 + 1*x2  =  3&quot;
</code></pre>

<pre><code class="r">c( R(A), R(cbind(A,b)) )          # show ranks
</code></pre>

<pre><code>## [1] 2 2
</code></pre>

<pre><code class="r">all.equal( R(A), R(cbind(A,b)) )  # consistent?
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<p>Plot them:</p>

<pre><code class="r">plotEqn(A,b)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAA81BMVEUAAAAAADoAAGYAOjoAOpAAZrYAzQAAzToAzWYA1WYA1ZAA3rY6AAA6ADo6AGY6OmY6OpA6ZrY6kNs6zQA6zTo6zWY61ZA659tmAABmADpmAGZmOgBmOpBmZmZmtv9mzQBmzTpmzWZm1QBm3mZm7v+QOgCQOjqQOmaQtpCQ1QCQ1TqQ1WaQ29uQ2/+Q7pCQ9/+2ZgC2kDq23gC25zq2/7a2//++vr7bkDrb5zrb/9vb////AAD/ADr/AGb/OgD/Ojr/Omb/OpD/ZgD/Zmb/Zrb/kDr/kNv/tmb/tpD/tv//25D/2///7mb/95D//7b//9v///8t7qb9AAAACXBIWXMAAAsSAAALEgHS3X78AAAUPklEQVR4nO3dD3vjxnHHcdzlxCTt2ZXPSS2r9bWOc3bS+GrVtSRbst3EyVkx46Pm/b+aEiApkcTuYAHs7M7s/r7P45MeiHMU72OAfwASDaEqa+bMltxV7l9AtnnwM2bVd5X7FxAN8N4Az00XHOC56YIDPDddcIDnpgsO8Nx0wQGemy44wHPTBVc9/Or8klZnTfPsxjFdcIA/v2ztafmeY7rgAH9+uTy92az5vWl3Py8Wv1pf+P5PjxNvf9ub7ha/v1j83j2dO8CfPfn8s3aNP+1t6z2zLfLX/0xf//qT3+1Qf3Zbrv7zC3r7my9c09mrHn695r5qTujuaV+OmW35WtIvP2gVv/zlf+/W+NXHm2+6H/zcAn95vMp7tw9JAzw37W2tvfr4q48vuz9oj3IHv/tBt9Z32/fF41Yfa7x00+Afd+oetlhsv3n7/i932++vFx90SzbwG98P9n5w/8cPjv/6vemMAZ6bPmzxIL9dj9dt78J7a/z2B6v/6LnvT2cM8Nz0UXvyu3vuLz/pNtt9+O4Hb9/fXuxwU++6309d9fDtizdd/Ud3/dlO/ud/unlYZ9/+6zf/1X7Xe7jW/eDBfa/96ZxVD79+UP/CO92rk/96sdjeS9//8fedZA9+84P/PVzPNz1OZw3wtPrwtW+6397W3naA56YdlSIPeG7aVSHygOemnZUhD3hu2l0R8oDnpj2VIA94btpXAfKA56a92ZcHPDftz7w84LlpJuvygOemuYzLA56bZrMtD3hums+0POC56YEsywOemx7KsDzguenB7MoDnpsezqw84LnpgKzKA56bDsmoPOC56aBsygOemw7LpDzguenALMoDnpsOzaA84Lnp4OzJA56bDs+cPOC56RFZkwc8Nz0mY/KA56ZHZUse8Nz0uEzJA56bHpklecBz02MzJA94bnp0duQBz02Pz4w84LnpCVmRBzw3PSUj8oDnpidlQx7w3PS0TMgDnpuemAV5wHPTUzMgD3huenL65QHPTU9PvTzguekZaZcHPDc9J+XygOemZ6VbHvDc9LxUywOem56ZZnnAc9NzUywPeG56dnrlAc9Nz0+tPOC56QhplQc8Nx0jpfKA56ajpFMe8Nx0nFTKA56bjpRGecBz07FSKA94bjpa+uQBz03HS5084LnpiGmTBzw3HTNl8oDnpqOmSx7w3HTcVMkDnpuOnCZ5wHPTsVMkD3huOnqAT5M6eD3ygOem46dmYw94blogLfKA56YlUiIPeG5aJB3ygOemZVIhD3huWigN8oDnpqVSIA94blqs/PKA56blyi4PeG5asNzygF8+b9qeXjqmJcssXz38/auX3de7Zzf9adHyylcPvzq/PPh6MC1bVvnq4fOt8Xnlq4en1Vme+/i2jPKA56bFyycPeMfUrui/T79s8oDnphOUSx7w3HSKMslXD799bOd6dJcGPpN89fDr53MvvNNpyiIPeFp9+No3nagc8oDnplOVQR7w3HSy0ssDnptOV3J5wHPTCUstD3huOmWJ5QHPTSctrTzguem0JZUHPDeduJTygOemU5dQHvDcdPLSyQOem05fMnnAc9MZSiUPeG46R4nkAc9NZymNPOC56TwlkQc8N52pFPKA56ZzlUAe8Nx0tuTlAc9N50tcHvDcdMak5QHPTedMWB7w3HTWZOUBz03nbSFJD3huOnOS8oDnprMnJw94bjp/YvKA56YVJCUPeG5aQ0LygOemVSQjD3huWkci8oDnppUkIQ94blpLAvKA56bVFF8e8Ny0nqLLA56bVlRsecBz05qKLA94blpVceUBz03rKqo84LlpZcWUBzw3ra2I8oDnptUVTx7w3LS+oskDnptWWCx5wHPTGoskD3huWmVx5AHPTessijzguWmlxZAHPDettQjygOem1TZfHvDctN5mywOem1bcXHnAc9OamykPeG5adfPkAc9N626WPOC5aeXNkQc8N629GfKA56bVN10e8Ny0/ibLA56bNtBUecBz0xaaKA94btpE0+QBz03baJI84LlpI02RBzw3baUJ8oDnps00Xh7w3LSdRssDnps21Fh5wHPTlgL8XjXBj5QHPDdtqnEbe8Bz07YaJQ94btpYY+QBz01ba4Q84Llpc4XLA56btlewPOC5aYOFygOem7ZYoHz18KvzS1qdNc2zG8e0ycLkAX9+2drT8j3HtM2C5AF/frk8vdms+bupXbK/nFwh8oA/e/L5Z+0af9rb1puFD5GvHp7o/lVzQndPL3s/sAsfIA94btpug/KA56YNNyQPeG7a3fL29van9V3En/cWfTd4oe2C44v1BmM1IA94btrZ6tt/0PLbf7z581+/30He3R779S60XXB0sf5gvHh5wHPTzu7+tv7jh586xh9+pDd/ox++/fvOb/Wd50K7BQftDQrEygOem/a2Xn9X362Ruz9ob4u9+s5/oW6tb9fy28etvtymnnh5wHPTh7Vem+/uv/9xu+zNbffd1m9j+qPnQo8LHhOF5+QBz00fdrtpvebePghu77Yda3zvQnsLHpOFZ+QBz0332to/3lX/8Nf2vtsBvzy+0MOCdJt6YuQBz027eljv25Z/uf+/dm3u+e27dxdaOp7LuQZj55MHPDft7M3tg/39+rna3V/I4ffmcbXeXOjN0aZimzi8Tx7w3LS/g/Ved255wHPTbGbsnfKA56aHurWB75IHPDcdkAl7hzzguenA9Nv35QHPTYen3b4nD3huelS67Y/lAc9Nj02z/ZE84LnpCem1P5QHPDc9La32B/KA56Ynp9N+Xx7w3PScNNrvyQOem56ZPvtHecBz0/PTZv8gD3huOkq67HfygOemY6XJfitfBfzyefPk9cEbYgOnI6bHfiNfA/z9q5fr/17khSc99p18DfAb8IuT3PCkxb6VrwG+XePXXf/i3ezwpMN+LV8DPK3OXrRfrh3vgeenhcpvXwn85Gm5ctsvruadfl55euEpt/3VvNPPK28Hv/r39gNu7j9Tsql/KKP91bzTzyvvYY1fPj+hi/a5/LjpBOWyv5p3+nnl7W3q75qX46fTlMX+at7p55VnYI3flN6+fVRfrrz2+/j9Ett3T+eKlVf9qL5fSvrN8/hS5Y3BU0L77Qs4hcrbg0+2yd+9clemvEV4SmP/8JJtkfJG4SmB/eNr9SXK24Unafu9nTQFypuGJ1H7/b1z5clbhyc5+4PdssXJFwBPQk/xDvfHlyZfBjxJ2B8diFGYfDHw8Tf5x0fgGJZ3nD6oIHiKbN879MqovPu8UWXBU0z7/jF3BuW9ZwsrDp6i2TsOtjQmz50jrkR4imPvOsrWkPzAmQELhacI9s7Dq43ID58Pslx4mmvvPq7egHzQWUCLhqdZ9p43VOiWDz73a+nwNN3e904avfJjzvhbATxNtPe+hUqn/MjTPNcBT1Ps/e+d0yc//uTe1cDTaHvmTZO65Ced0r0meBpnz71bVo/8JHWqDp5G2LNvk9YhP1WdaoSnUHv+/fH55WeoU6XwFGQ/8MEIeeXnqVO98DRsP/SJGPnkZ6tT1fA0YD/4USh55GOoU+3wxNkPfwZOevlI6gT4No99wIcfpZWPp06A3+ayD/nUq3TyUdUJ8I/17IM+7iyNfGx1AvxBh/Zhn3MnLj9ml9uYvxbwB+3ZB37Aoai8kDoB3tHOPvSTLcXkxdC7vxzwjjr5q9AdeSLyouoEeG8dfOCOvOjy0uoEeKar8B15UeUTqBPgmbr7+ED7RSz6NOoEeKbdg7sg+yjyydQJ8Ex7j+pD7OfKp1QnwDMdPp0btp8jn1idwuCXz7vfynH2iorgadh+qnx6dQqC356whu6e3fSnC871Ag5vP0U+izoFwe9OTbV3iqrdK4lXyGxY4335X7L1r/dj1vlc6/r22gPwVme4jz/OZx8qn1ed8KieaWgnjds+RD67OgGeKWDvnMt+SF6DOgGeKWy3bN+ek1eiToBnCj7T5O0Rvk9ejzoBnmnMKUYP7V3yqtQJ8Exjzy27Z38sr02dAM804aTCD/Zr+QdnheoEeKZpZ5Pe2jfNglpsneoEeKbJpxHv4NutvVp1AjzTnPPHN7e3a/lbreoEeKZZ8E3TyjfZzoE+GOC9TYbfbeEXzSL4QN3kAd7bRPjm4Z59/QBvEXygbuoA720K/N6jufZL93xeJz3gvY2GdzyI376So9Ae8N7GwXueuu1ew1O3yQe8txHwzBP2x1dvddkD3lso/MDLNPuv2yuyB7y3IPiAF+cO99hooQe8t2H4wJdkj/fVqbAHvLch+PAX4nv75xVs8gHvjYUft/vFcWRGbnvAe/PDj9/r5jwaK6s94L154Kfta/Uch5fPHvDeXPDT97B7j73NRA94bz34ecdVMEdd57AHvLdD+PlH03DH26ff5APe2x58nGOo+PfYJLYHvLcdfLwj54beXZXSHvDeOvi4x0sOv6MymT3gvV0JHCUb8l7aNPaA99Q0VxLHRoe9fz6BPeBddeRXIsdGh35ygrQ94HvtNvBzDq9mCv+0FFF7wB+2d7cuBD/qc3JuxfABv9fhgzkp+JGfiiZkD/hdvYfwYvA0+uPwBOwB3+V64iYHP14+vj3gvS/SiMJP+fDTqPbVw/tfpBGEn/yxt/Hs64ZnX5qThJ/xUdeR7CuGH3pBVhR+1oecx7CvFT7gZXhZ+JknNphtXyV82M4XYfjZp7SYZ18ffPAuN2n4COeummFfGfyYHa3i8FHOWjbVvib4kbvX5eEjna9ukn018OMPqkgAH+1MhePt64CfdChNCviI56gcaV8B/NQDqJLARz076ZgdeaXDzzhsLg185DMSB9sXDT/vYMlE8PHPRR1kXy787ENkU8FLnH9+2L5Q+BgHRieDl5AftC8RPtLh8OngZeR5++Lg470JIiG8lDxjXxZ81Le+pISXk/fZFwQfVZ0Sw0vKb+yPFpUCH1udUsPLyvcrAl5AnZLDJ5a3Dy+jTunh08rbhm/E1CkDfFJ5w/Ci6pQDPqW8VXhh9LYM8AnlTcInUKc88Onk7cGnUadM8MnkjcEnU6dc8KnkLcGnVKds8InkzcAnVqd88GnkbcCnV6eM8EnkDcBnUaec8CnktcPnUqes8AnkVcNnVKe88PLyeuHzqlNmeHF5pfDZ1Sk3vLS8RngN6pQdXlheHbwSdcoPLyuvC16POimAF5VXBK9KnTTAS8oHwK/OL2l11jTPbhzT0X4PZeqkAl5QPgy+tafle47pOL+EPnXSAS8nHwa/PL3ZrPm96Qi/gUp1UgIvJh8Cf/bk88/aNf60t62fzaVWnbTAt/IS9EEP7u5fNSd09/Rxhd8d5zhPTLM6qYEXks/2qF65OumBl9nc54HXr06a4CXkg+GvXzinp1ylBXVSBS8gnxreijrpgo8vnxbejjopg48un/A+3pQ6aYOPLZ8K3tAmfpcy+MjySeANqpM++Ljy8vA21UkhfFR5YXiz6qQRPqa8JLxldVIJH1FeDN64OumEjycvBL9RX77b25FLy+dN8zJgWf5UwkeTl4Dfret3zdMe/OrD17R85/XgMgXphI8lHx1+u4m/PqGLJ384WOMvXtD1yd1J+93h6u1apiCl8JHk48Jv1VfnX3VH6xxu6ndLuzW83R607bg3y1SlFT6OfHz49ut1072yf3Qfv116/6r/sr9rWe7UwkeRl3lwt73H3sJfNM3J49LVWd/YtSx7euFjyMvAX3y0kT5c47uly+fbrfvepv5hmaoUw0eQF4Ffnn7zabtyH8J3S13GOt1Vw8+Xl4C/f/WS7tq3XxzAb5b+z8FDuk3XjmUKUg0/W17RW6i0pRt+rjzgvSmHnykPeG/a4efJA96bevhZ8oD3ph9+jjzgvRmAnyEPeG8W4KfLA96bCfjJ8oD3ZgN+qjzgvRmBnygPeG9W4KfJA96bGfhJ8oD3Zgd+ijzgvRmCnyAPeG+W4MfLA96bKfjR8oD3Zgt+rDzgvRmDHykPeG/W4MfJA96bOfhR8oD3Zg9+jDzgvRmEHyEPeG8W4cPlAe/NJHywPOC92YQPlQe8N6PwgfKA92YVPkwe8N7MwgfJA96bXfgQecB7MwwfIA94b5bhh+UB7800/KA84L3Zhh+SB7w34/AD8oD3Zh2elwe8N/PwrDzgvdmH5+QB760AeEYe8N5KgPfLA95bEfBeecB7KwPeJw94b4XAe+QB760UeLc84L0VA++UB7y3cuBd8oD3VhC8Qx7w3kqCJ8CHVxR8L8B7Azw3XXCA56YLDvDcdMEBnpsuOMBz0wUHeG664ADPTRcc4LnpggM8N11wgOemCw7w3HTBAZ6bLjjAc9MFB3hmuuSucv8CskVdaxNtAdJcTVE3xnE1gM96LYBXdzVF3RjAa7sWwKu7mqJuDOC1XQvg1V1NUTcG8NqupQx4ZCjAVxrgKw3wlQb4SgN8pQG+0gBfaYCvtKjw969exvzr3C2fN4301azOmmc3wtdBaW5KlwMmKvx1gpux+vA1Ld95LXod7b/T9YnoVbSluCmbHDAx4Zf/8m/y8HctyIXs9azOL2n57qXodVCam9LlgokIf//p5yk29bRZVSRbnt6IX8e2FFfjhIkIf/0iyX18uyV+IXsFd89SwYvflDYnTBz4i6Y5Wa8m0vDt1bSPvKT/sZKt8fI3hbpbI/rg7ro7Xlv+hiyfi29WEt3Hp7gp5IMx93QuxT9WuwFO8Kg+jXub9NO5FPCb/3+FryfN8/gkN6VLGh7ZCfCVBvhKA3ylAb7SAF9pgK80wFca4CsN8JUG+EoDfKUBvtIAX2mArzTAVxrgKw3wlQb4SgN8pQHeW4oDrPMFeF93zVPAV9VFd1D9xZM/YI2vq9X5V+ctOTb1tXW9eb8R4Gtr+2EFgK+ti4+6980BvrKWp9982q7ygK+r9g2G7ScjAB6VGOArDfCVBvhK+3/AggHzaYWNqgAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-5"/> </p>

<h3>Three inconsistent equations</h3>

<pre><code class="r">A &lt;- matrix(c(1,2,3, -1, 2, 1), 3, 2)
b &lt;- c(2,1,6)
showEqn(A, b)
</code></pre>

<pre><code>##      [,1]               
## [1,] &quot;1*x1 - 1*x2  =  2&quot;
## [2,] &quot;2*x1 + 2*x2  =  1&quot;
## [3,] &quot;3*x1 + 1*x2  =  6&quot;
</code></pre>

<pre><code class="r">c( R(A), R(cbind(A,b)) )          # show ranks
</code></pre>

<pre><code>## [1] 2 3
</code></pre>

<pre><code class="r">all.equal( R(A), R(cbind(A,b)) )  # consistent?
</code></pre>

<pre><code>## [1] &quot;Mean relative difference: 0.5&quot;
</code></pre>

<p>An approximate solution is sometimes available using a generalized inverse.</p>

<pre><code class="r">x &lt;- MASS::ginv(A) %*% b
x
</code></pre>

<pre><code>##      [,1]
## [1,]    2
## [2,]   -1
</code></pre>

<p>Plot the equations. You can see that each pair of equations has a solution,
but all three do not have a common, consistent solution.</p>

<pre><code class="r">plotEqn(A,b, xlim=c(-2, 4))
points(x[1], x[2], pch=15)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<h2>Equations in three unknowns</h2>

<p>Each equation in three unknowns corresponds to a plane in 3D space. The equations
have a unique solution if all planes intersect in a point.</p>

<h3>Three consistent equations</h3>

<pre><code class="r">A &lt;- matrix(c(2, 1, -1,
             -3, -1, 2,
             -2,  1, 2), 3, 3, byrow=TRUE)
colnames(A) &lt;- paste0(&#39;x&#39;, 1:3)
b &lt;- c(8, -11, -3)
showEqn(A, b)
</code></pre>

<pre><code>##      [,1]                         
## [1,] &quot;2*x1 + 1*x2 - 1*x3  =  8&quot;   
## [2,] &quot;-3*x1 - 1*x2 + 2*x3  =  -11&quot;
## [3,] &quot;-2*x1 + 1*x2 + 2*x3  =  -3&quot;
</code></pre>

<p>Are the equations consistent?</p>

<pre><code class="r">c( R(A), R(cbind(A,b)) )          # show ranks
</code></pre>

<pre><code>## [1] 3 3
</code></pre>

<pre><code class="r">all.equal( R(A), R(cbind(A,b)) )  # consistent?
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<p>Solve for \(\mathbf{x}\).  </p>

<pre><code class="r">solve(A, b)
</code></pre>

<pre><code>## x1 x2 x3 
##  2  3 -1
</code></pre>

<pre><code class="r">solve(A) %*% b
</code></pre>

<pre><code>##    [,1]
## x1    2
## x2    3
## x3   -1
</code></pre>

<pre><code class="r">inv(A) %*% b
</code></pre>

<pre><code>##      [,1]
## [1,]    2
## [2,]    3
## [3,]   -1
</code></pre>

<p>Another way to see the solution is to reduce \(\mathbf{A | b}\) to echelon form. The result is \(\mathbf{I | A^{-1}b}\),
with the solution in the last column. </p>

<pre><code class="r">echelon(A, b)
</code></pre>

<pre><code>##      x1 x2 x3   
## [1,]  1  0  0  2
## [2,]  0  1  0  3
## [3,]  0  0  1 -1
</code></pre>

<pre><code class="r">echelon(A, b, verbose=TRUE, fractions=TRUE)
</code></pre>

<pre><code>## row: 1 
##      x1   x2   x3       
## [1,]    1  1/3 -2/3 11/3
## [2,]    0  1/3  1/3  2/3
## [3,]    0  5/3  2/3 13/3
## row: 2 
##      x1   x2   x3       
## [1,]    1    0 -4/5 14/5
## [2,]    0    1  2/5 13/5
## [3,]    0    0  1/5 -1/5
## row: 3 
##      x1 x2 x3   
## [1,]  1  0  0  2
## [2,]  0  1  0  3
## [3,]  0  0  1 -1
</code></pre>

<pre><code>##      x1 x2 x3   
## [1,]  1  0  0  2
## [2,]  0  1  0  3
## [3,]  0  0  1 -1
</code></pre>

<p>Plot them.  <code>plotEqn3d</code> uses <code>rgl</code> for 3D graphics.  If you rotate the figure, you&#39;ll see an orientation
where all three planes intersect at the solution point, \(\mathbf{x} = (2, 3, -1)\) </p>

<pre><code class="r">plotEqn3d(A,b, xlim=c(0,4), ylim=c(0,4))
</code></pre>

<script src="CanvasMatrix.js" type="text/javascript"></script>

<p><canvas id="plotEqn1textureCanvas" style="display: none;" width="256" height="256">
<img src="data:image/png;base64,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" alt="plotEqn1snapshot" width=505/><br>
Your browser does not support the HTML5 canvas element.</canvas></p>

<script type="text/javascript">
var min = Math.min,
max = Math.max,
sqrt = Math.sqrt,
sin = Math.sin,
acos = Math.acos,
tan = Math.tan,
SQRT2 = Math.SQRT2,
PI = Math.PI,
log = Math.log,
exp = Math.exp,
vshader, fshader,
rglClass = function() {
this.zoom = [];
this.FOV  = [];
this.userMatrix = [];
this.viewport = [];
this.listeners = [];
this.clipplanes = [];
this.opaque = [];
this.transparent = [];
this.subscenes = [];
this.vshaders = [];
this.fshaders = [];
this.flags = [];
this.prog = [];
this.ofsLoc = [];
this.origLoc = [];
this.sizeLoc = [];
this.usermatLoc = [];
this.vClipplane = [];
this.texture = [];
this.texLoc = [];
this.sampler = [];
this.origsize = [];
this.values = [];
this.offsets = [];
this.normLoc = [];
this.clipLoc = [];
this.centers = [];
this.f = [];
this.buf = [];
this.ibuf = [];
this.mvMatLoc = [];
this.prMatLoc = [];
this.textScaleLoc = [];
this.normMatLoc = [];
this.IMVClip = [];
this.drawFns = [];
this.clipFns = [];
this.prMatrix = new CanvasMatrix4();
this.mvMatrix = new CanvasMatrix4();
this.vp = null;
this.prmvMatrix = null;
this.origs = null;
this.gl = null;
};
(function() {
this.getShader = function( gl, shaderType, code ){
var shader;
shader = gl.createShader ( shaderType );
gl.shaderSource(shader, code);
gl.compileShader(shader);
if (gl.getShaderParameter(shader, gl.COMPILE_STATUS) === 0)
alert(gl.getShaderInfoLog(shader));
return shader;
};
this.multMV = function(M, v) {
return [M.m11*v[0] + M.m12*v[1] + M.m13*v[2] + M.m14*v[3],
M.m21*v[0] + M.m22*v[1] + M.m23*v[2] + M.m24*v[3],
M.m31*v[0] + M.m32*v[1] + M.m33*v[2] + M.m34*v[3],
M.m41*v[0] + M.m42*v[1] + M.m43*v[2] + M.m44*v[3]];
};
this.f_is_lit = 1;
this.f_is_smooth = 2;
this.f_has_texture = 4;
this.f_is_indexed = 8;
this.f_depth_sort = 16;
this.f_fixed_quads = 32;
this.f_is_transparent = 64;
this.f_is_lines = 128;
this.f_sprites_3d = 256;
this.f_sprite_3d = 512;
this.f_is_subscene = 1024;
this.f_is_clipplanes = 2048;
this.f_reuse = 4096;
this.whichList = function(id) {
if (this.flags[id] & this.f_is_subscene)
return "subscenes";
else if (this.flags[id] & this.f_is_clipplanes)
return "clipplanes";
else if (this.flags[id] & this.f_is_transparent)
return "transparent";
else
return "opaque";
};
this.inSubscene = function(id, subscene) {
var thelist = this.whichList(id);
return this[thelist][subscene].indexOf(id) > -1;
};
this.addToSubscene = function(id, subscene) {
var thelist = this.whichList(id);
if (this[thelist][subscene].indexOf(id) == -1)
this[thelist][subscene].push(id);
};
this.delFromSubscene = function(id, subscene) {
var thelist = this.whichList(id),
i = this[thelist][subscene].indexOf(id);
if (i > -1)
this[thelist][subscene].splice(i, 1);
};
this.setSubsceneEntries = function(ids, subscene) {
this.subscenes[subscene] = [];
this.clipplanes[subscene] = [];
this.transparent[subscene] = [];
this.opaque[subscene] = [];
for (var i = 0; i < ids.length; i++)
this.addToSubscene(ids[i], subscene);
};
this.getSubsceneEntries = function(subscene) {
return(this.subscenes[subscene].concat(this.clipplanes[subscene]).
concat(this.transparent[subscene]).concat(this.opaque[subscene]));
};
this.getPowerOfTwo = function(value) {
var pow = 1;
while(pow<value) {
pow *= 2;
}
return pow;
};
this.handleLoadedTexture = function(id) {
var gl = this.gl, textureCanvas = this.textureCanvas;
gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
gl.bindTexture(gl.TEXTURE_2D, this.texture[id]);
gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
gl.generateMipmap(gl.TEXTURE_2D);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);
gl.bindTexture(gl.TEXTURE_2D, null);
};
this.loadImageNowOrLater = function(name, id) {
var image = document.getElementById(name),
self = this;
if (image.rglTextureLoaded) {
this.loadImageToTexture(image, id);
} else {
image.addEventListener("load", 
function() {
self.loadImageToTexture(this, id);
}); 
}
};
this.loadImageToTexture = function(image, id) {
var canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
w = image.width,
h = image.height,
canvasX = this.getPowerOfTwo(w),
canvasY = this.getPowerOfTwo(h),
gl = this.gl,
maxTexSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);
image.rglTextureLoaded = true;
while (canvasX > 1 && (canvasX > maxTexSize || canvasY > maxTexSize)) {
canvasX /= 2;
canvasY /= 2;
}
canvas.width = canvasX;
canvas.height = canvasY;
ctx.imageSmoothingEnabled = true;
ctx.drawImage(image, 0, 0, canvasX, canvasY);
image.style.display = "none";
this.handleLoadedTexture(id);
this.drawScene();
};
}).call(rglClass.prototype);
var plotEqn1rgl = new rglClass();
plotEqn1rgl.start = function() {
var i, j, v, ind, texts, f, texinfo, canvas;
var debug = function(msg) {
document.getElementById("plotEqn1debug").innerHTML = msg;
};
debug("");
canvas = this.canvas = document.getElementById("plotEqn1canvas");
this.textureCanvas = document.getElementById("plotEqn1textureCanvas");
if (!window.WebGLRenderingContext){
debug("<img src=\"plotEqn1snapshot.png\" alt=\"plotEqn1snapshot\" width=505/><br> Your browser does not support WebGL. See <a href=\"http://get.webgl.org\">http://get.webgl.org</a>");
return;
}
try {
// Try to grab the standard context. If it fails, fallback to experimental.
this.gl = canvas.getContext("webgl") ||
canvas.getContext("experimental-webgl");
}
catch(e) {}
if ( !this.gl ) {
debug("<img src=\"plotEqn1snapshot.png\" alt=\"plotEqn1snapshot\" width=505/><br> Your browser appears to support WebGL, but did not create a WebGL context.  See <a href=\"http://get.webgl.org\">http://get.webgl.org</a>");
return;
}
var gl = this.gl,
width = 505, height = 505;
canvas.width = width;   canvas.height = height;
var normMatrix = new CanvasMatrix4(),
saveMat = {},
distance,
posLoc = 0,
colLoc = 1;
var activeSubscene = 1;
this.flags[1] = 1259;
this.zoom[1] = 1;
this.FOV[1] = 30;
this.viewport[1] = [0, 0, 504, 504];
this.userMatrix[1] = new CanvasMatrix4();
this.userMatrix[1].load([
1, 0, 0, 0,
0, 0.3420201, -0.9396926, 0,
0, 0.9396926, 0.3420201, 0,
0, 0, 0, 1
]);
this.clipplanes[1] = [];
this.opaque[1] = [10,12,13,14,16,17,18,19,20,21,22,23];
this.transparent[1] = [15];
this.subscenes[1] = [7];
this.flags[7] = 3200;
this.viewport[7] = [0, 0, 504, 504];
this.clipplanes[7] = [8];
this.opaque[7] = [9];
this.transparent[7] = [];
this.subscenes[7] = [];
function drawTextToCanvas(text, cex) {
var canvasX, canvasY,
textX, textY,
textHeight = 20 * cex,
textColour = "white",
fontFamily = "Arial",
backgroundColour = "rgba(0,0,0,0)",
canvas = document.getElementById("plotEqn1textureCanvas"),
ctx = canvas.getContext("2d"),
i;
ctx.font = textHeight+"px "+fontFamily;
canvasX = 1;
var widths = [];
for (i = 0; i < text.length; i++)  {
widths[i] = ctx.measureText(text[i]).width;
canvasX = (widths[i] > canvasX) ? widths[i] : canvasX;
}
canvasX = plotEqn1rgl.getPowerOfTwo(canvasX);
var offset = 2*textHeight, // offset to first baseline
skip = 2*textHeight;   // skip between baselines
canvasY = plotEqn1rgl.getPowerOfTwo(offset + text.length*skip);
canvas.width = canvasX;
canvas.height = canvasY;
ctx.fillStyle = backgroundColour;
ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
ctx.fillStyle = textColour;
ctx.textAlign = "left";
ctx.textBaseline = "alphabetic";
ctx.font = textHeight+"px "+fontFamily;
for(i = 0; i < text.length; i++) {
textY = i*skip + offset;
ctx.fillText(text[i], 0,  textY);
}
return {canvasX:canvasX, canvasY:canvasY,
widths:widths, textHeight:textHeight,
offset:offset, skip:skip};
}
// ****** sphere object ******
this.sphereverts = new Float32Array([
-1, 0, 0,
1, 0, 0,
0, -1, 0,
0, 1, 0,
0, 0, -1,
0, 0, 1,
-0.7071068, 0, -0.7071068,
-0.7071068, -0.7071068, 0,
0, -0.7071068, -0.7071068,
-0.7071068, 0, 0.7071068,
0, -0.7071068, 0.7071068,
-0.7071068, 0.7071068, 0,
0, 0.7071068, -0.7071068,
0, 0.7071068, 0.7071068,
0.7071068, -0.7071068, 0,
0.7071068, 0, -0.7071068,
0.7071068, 0, 0.7071068,
0.7071068, 0.7071068, 0,
-0.9349975, 0, -0.3546542,
-0.9349975, -0.3546542, 0,
-0.77044, -0.4507894, -0.4507894,
0, -0.3546542, -0.9349975,
-0.3546542, 0, -0.9349975,
-0.4507894, -0.4507894, -0.77044,
-0.3546542, -0.9349975, 0,
0, -0.9349975, -0.3546542,
-0.4507894, -0.77044, -0.4507894,
-0.9349975, 0, 0.3546542,
-0.77044, -0.4507894, 0.4507894,
0, -0.9349975, 0.3546542,
-0.4507894, -0.77044, 0.4507894,
-0.3546542, 0, 0.9349975,
0, -0.3546542, 0.9349975,
-0.4507894, -0.4507894, 0.77044,
-0.9349975, 0.3546542, 0,
-0.77044, 0.4507894, -0.4507894,
0, 0.9349975, -0.3546542,
-0.3546542, 0.9349975, 0,
-0.4507894, 0.77044, -0.4507894,
0, 0.3546542, -0.9349975,
-0.4507894, 0.4507894, -0.77044,
-0.77044, 0.4507894, 0.4507894,
0, 0.3546542, 0.9349975,
-0.4507894, 0.4507894, 0.77044,
0, 0.9349975, 0.3546542,
-0.4507894, 0.77044, 0.4507894,
0.9349975, -0.3546542, 0,
0.9349975, 0, -0.3546542,
0.77044, -0.4507894, -0.4507894,
0.3546542, -0.9349975, 0,
0.4507894, -0.77044, -0.4507894,
0.3546542, 0, -0.9349975,
0.4507894, -0.4507894, -0.77044,
0.9349975, 0, 0.3546542,
0.77044, -0.4507894, 0.4507894,
0.3546542, 0, 0.9349975,
0.4507894, -0.4507894, 0.77044,
0.4507894, -0.77044, 0.4507894,
0.9349975, 0.3546542, 0,
0.77044, 0.4507894, -0.4507894,
0.4507894, 0.4507894, -0.77044,
0.3546542, 0.9349975, 0,
0.4507894, 0.77044, -0.4507894,
0.77044, 0.4507894, 0.4507894,
0.4507894, 0.77044, 0.4507894,
0.4507894, 0.4507894, 0.77044
]);
this.spherefaces=new Uint16Array([
0, 18, 19,
6, 20, 18,
7, 19, 20,
19, 18, 20,
4, 21, 22,
8, 23, 21,
6, 22, 23,
22, 21, 23,
2, 24, 25,
7, 26, 24,
8, 25, 26,
25, 24, 26,
7, 20, 26,
6, 23, 20,
8, 26, 23,
26, 20, 23,
0, 19, 27,
7, 28, 19,
9, 27, 28,
27, 19, 28,
2, 29, 24,
10, 30, 29,
7, 24, 30,
24, 29, 30,
5, 31, 32,
9, 33, 31,
10, 32, 33,
32, 31, 33,
9, 28, 33,
7, 30, 28,
10, 33, 30,
33, 28, 30,
0, 34, 18,
11, 35, 34,
6, 18, 35,
18, 34, 35,
3, 36, 37,
12, 38, 36,
11, 37, 38,
37, 36, 38,
4, 22, 39,
6, 40, 22,
12, 39, 40,
39, 22, 40,
6, 35, 40,
11, 38, 35,
12, 40, 38,
40, 35, 38,
0, 27, 34,
9, 41, 27,
11, 34, 41,
34, 27, 41,
5, 42, 31,
13, 43, 42,
9, 31, 43,
31, 42, 43,
3, 37, 44,
11, 45, 37,
13, 44, 45,
44, 37, 45,
11, 41, 45,
9, 43, 41,
13, 45, 43,
45, 41, 43,
1, 46, 47,
14, 48, 46,
15, 47, 48,
47, 46, 48,
2, 25, 49,
8, 50, 25,
14, 49, 50,
49, 25, 50,
4, 51, 21,
15, 52, 51,
8, 21, 52,
21, 51, 52,
15, 48, 52,
14, 50, 48,
8, 52, 50,
52, 48, 50,
1, 53, 46,
16, 54, 53,
14, 46, 54,
46, 53, 54,
5, 32, 55,
10, 56, 32,
16, 55, 56,
55, 32, 56,
2, 49, 29,
14, 57, 49,
10, 29, 57,
29, 49, 57,
14, 54, 57,
16, 56, 54,
10, 57, 56,
57, 54, 56,
1, 47, 58,
15, 59, 47,
17, 58, 59,
58, 47, 59,
4, 39, 51,
12, 60, 39,
15, 51, 60,
51, 39, 60,
3, 61, 36,
17, 62, 61,
12, 36, 62,
36, 61, 62,
17, 59, 62,
15, 60, 59,
12, 62, 60,
62, 59, 60,
1, 58, 53,
17, 63, 58,
16, 53, 63,
53, 58, 63,
3, 44, 61,
13, 64, 44,
17, 61, 64,
61, 44, 64,
5, 55, 42,
16, 65, 55,
13, 42, 65,
42, 55, 65,
16, 63, 65,
17, 64, 63,
13, 65, 64,
65, 63, 64
]);
var sphereBuf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, sphereBuf);
gl.bufferData(gl.ARRAY_BUFFER, plotEqn1rgl.sphereverts, gl.STATIC_DRAW);
var sphereIbuf = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphereIbuf);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, plotEqn1rgl.spherefaces, gl.STATIC_DRAW);
// ****** clipplanes object 8 ******
this.flags[8] = 2048;
this.vClipplane[8]=[
1, 0, 0, -0,
-1, 0, 0, 4,
0, 1, 0, -0,
0, -1, 0, 4,
0, 0, 1, 3,
0, 0, -1, 3
];
// ****** lines object 9 ******
this.flags[9] = 128;
this.vshaders[9] = "    /* ****** lines object 9 vertex shader ****** */\n  attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   void main(void) {\n   vPosition = mvMatrix * vec4(aPos, 1.);\n    gl_Position = prMatrix * vPosition;\n   vCol = aCol;\n    }";
this.fshaders[9] = "    /* ****** lines object 9 fragment shader ****** */\n    #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   uniform vec4 vClipplane1;\n uniform vec4 vClipplane2;\n uniform vec4 vClipplane3;\n uniform vec4 vClipplane4;\n uniform vec4 vClipplane5;\n uniform vec4 vClipplane6;\n void main(void) {\n   if (dot(vPosition, vClipplane1) < 0.0) discard;\n   if (dot(vPosition, vClipplane2) < 0.0) discard;\n   if (dot(vPosition, vClipplane3) < 0.0) discard;\n   if (dot(vPosition, vClipplane4) < 0.0) discard;\n   if (dot(vPosition, vClipplane5) < 0.0) discard;\n   if (dot(vPosition, vClipplane6) < 0.0) discard;\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   gl_FragColor = lighteffect;\n }";
this.prog[9]  = gl.createProgram();
gl.attachShader(this.prog[9], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[9] ));
gl.attachShader(this.prog[9], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[9] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[9], 0, "aPos");
gl.bindAttribLocation(this.prog[9], 1, "aCol");
gl.linkProgram(this.prog[9]);
this.offsets[9]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1, tofs:-1, stride:3};
v=new Float32Array([
1, 1, 1,
1, 1, 1,
3, 3, 3,
3, 3, 3
]);
this.values[9] = v;
this.clipLoc[9] = [];
this.clipLoc[9][0] = gl.getUniformLocation(this.prog[9], "vClipplane1");
this.clipLoc[9][1] = gl.getUniformLocation(this.prog[9], "vClipplane2");
this.clipLoc[9][2] = gl.getUniformLocation(this.prog[9], "vClipplane3");
this.clipLoc[9][3] = gl.getUniformLocation(this.prog[9], "vClipplane4");
this.clipLoc[9][4] = gl.getUniformLocation(this.prog[9], "vClipplane5");
this.clipLoc[9][5] = gl.getUniformLocation(this.prog[9], "vClipplane6");
this.buf[9] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[9]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[9], gl.STATIC_DRAW);
this.mvMatLoc[9] = gl.getUniformLocation(this.prog[9],"mvMatrix");
this.prMatLoc[9] = gl.getUniformLocation(this.prog[9],"prMatrix");
// ****** lines object 10 ******
this.flags[10] = 128;
this.vshaders[10] = "   /* ****** lines object 10 vertex shader ****** */\n attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   void main(void) {\n   vPosition = mvMatrix * vec4(aPos, 1.);\n    gl_Position = prMatrix * vPosition;\n   vCol = aCol;\n    }";
this.fshaders[10] = "   /* ****** lines object 10 fragment shader ****** */\n   #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   gl_FragColor = lighteffect;\n }";
this.prog[10]  = gl.createProgram();
gl.attachShader(this.prog[10], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[10] ));
gl.attachShader(this.prog[10], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[10] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[10], 0, "aPos");
gl.bindAttribLocation(this.prog[10], 1, "aCol");
gl.linkProgram(this.prog[10]);
this.offsets[10]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1, tofs:-1, stride:3};
v=new Float32Array([
0, 0, -3,
0, 0, -3,
4, 4, 3,
4, 4, 3
]);
this.values[10] = v;
this.buf[10] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[10]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[10], gl.STATIC_DRAW);
this.mvMatLoc[10] = gl.getUniformLocation(this.prog[10],"mvMatrix");
this.prMatLoc[10] = gl.getUniformLocation(this.prog[10],"prMatrix");
// ****** text object 12 ******
this.flags[12] = 40;
this.vshaders[12] = "   /* ****** text object 12 vertex shader ****** */\n  attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   attribute vec2 aTexcoord;\n varying vec2 vTexcoord;\n   uniform vec2 textScale;\n   attribute vec2 aOfs;\n  void main(void) {\n   vCol = aCol;\n      vTexcoord = aTexcoord;\n    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n      pos = pos/pos.w;\n      gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n    }";
this.fshaders[12] = "   /* ****** text object 12 fragment shader ****** */\n    #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   varying vec2 vTexcoord;\n   uniform sampler2D uSampler;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n   if (textureColor.a < 0.1)\n       discard;\n    else\n        gl_FragColor = textureColor;\n  }";
this.prog[12]  = gl.createProgram();
gl.attachShader(this.prog[12], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[12] ));
gl.attachShader(this.prog[12], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[12] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[12], 0, "aPos");
gl.bindAttribLocation(this.prog[12], 1, "aCol");
gl.linkProgram(this.prog[12]);
texts = [
"x1"
];
texinfo = drawTextToCanvas(texts, 1);
this.ofsLoc[12] = gl.getAttribLocation(this.prog[12], "aOfs");
this.texture[12] = gl.createTexture();
this.texLoc[12] = gl.getAttribLocation(this.prog[12], "aTexcoord");
this.sampler[12] = gl.getUniformLocation(this.prog[12],"uSampler");
this.handleLoadedTexture(12);
this.offsets[12]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:5, tofs:3, stride:7};
v=new Float32Array([
2, -0.678, -4.017, 0, -0.5, 0.5, 0.5,
2, -0.678, -4.017, 1, -0.5, 0.5, 0.5,
2, -0.678, -4.017, 1, 1.5, 0.5, 0.5,
2, -0.678, -4.017, 0, 1.5, 0.5, 0.5
]);
for (i=0; i<1; i++)
for (j=0; j<4; j++) {
ind = this.offsets[12].stride*(4*i + j) + this.offsets[12].tofs;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i];
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip -
v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
this.values[12] = v;
f=new Uint16Array([
0, 1, 2, 0, 2, 3
]);
this.buf[12] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[12]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[12], gl.STATIC_DRAW);
this.ibuf[12] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[12]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
this.mvMatLoc[12] = gl.getUniformLocation(this.prog[12],"mvMatrix");
this.prMatLoc[12] = gl.getUniformLocation(this.prog[12],"prMatrix");
this.textScaleLoc[12] = gl.getUniformLocation(this.prog[12],"textScale");
// ****** text object 13 ******
this.flags[13] = 40;
this.vshaders[13] = "   /* ****** text object 13 vertex shader ****** */\n  attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   attribute vec2 aTexcoord;\n varying vec2 vTexcoord;\n   uniform vec2 textScale;\n   attribute vec2 aOfs;\n  void main(void) {\n   vCol = aCol;\n      vTexcoord = aTexcoord;\n    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n      pos = pos/pos.w;\n      gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n    }";
this.fshaders[13] = "   /* ****** text object 13 fragment shader ****** */\n    #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   varying vec2 vTexcoord;\n   uniform sampler2D uSampler;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n   if (textureColor.a < 0.1)\n       discard;\n    else\n        gl_FragColor = textureColor;\n  }";
this.prog[13]  = gl.createProgram();
gl.attachShader(this.prog[13], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[13] ));
gl.attachShader(this.prog[13], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[13] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[13], 0, "aPos");
gl.bindAttribLocation(this.prog[13], 1, "aCol");
gl.linkProgram(this.prog[13]);
texts = [
"x2"
];
texinfo = drawTextToCanvas(texts, 1);
this.ofsLoc[13] = gl.getAttribLocation(this.prog[13], "aOfs");
this.texture[13] = gl.createTexture();
this.texLoc[13] = gl.getAttribLocation(this.prog[13], "aTexcoord");
this.sampler[13] = gl.getUniformLocation(this.prog[13],"uSampler");
this.handleLoadedTexture(13);
this.offsets[13]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:5, tofs:3, stride:7};
v=new Float32Array([
-0.678, 2, -4.017, 0, -0.5, 0.5, 0.5,
-0.678, 2, -4.017, 1, -0.5, 0.5, 0.5,
-0.678, 2, -4.017, 1, 1.5, 0.5, 0.5,
-0.678, 2, -4.017, 0, 1.5, 0.5, 0.5
]);
for (i=0; i<1; i++)
for (j=0; j<4; j++) {
ind = this.offsets[13].stride*(4*i + j) + this.offsets[13].tofs;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i];
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip -
v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
this.values[13] = v;
f=new Uint16Array([
0, 1, 2, 0, 2, 3
]);
this.buf[13] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[13]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[13], gl.STATIC_DRAW);
this.ibuf[13] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[13]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
this.mvMatLoc[13] = gl.getUniformLocation(this.prog[13],"mvMatrix");
this.prMatLoc[13] = gl.getUniformLocation(this.prog[13],"prMatrix");
this.textScaleLoc[13] = gl.getUniformLocation(this.prog[13],"textScale");
// ****** text object 14 ******
this.flags[14] = 40;
this.vshaders[14] = "   /* ****** text object 14 vertex shader ****** */\n  attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   attribute vec2 aTexcoord;\n varying vec2 vTexcoord;\n   uniform vec2 textScale;\n   attribute vec2 aOfs;\n  void main(void) {\n   vCol = aCol;\n      vTexcoord = aTexcoord;\n    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n      pos = pos/pos.w;\n      gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n    }";
this.fshaders[14] = "   /* ****** text object 14 fragment shader ****** */\n    #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   varying vec2 vTexcoord;\n   uniform sampler2D uSampler;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n   if (textureColor.a < 0.1)\n       discard;\n    else\n        gl_FragColor = textureColor;\n  }";
this.prog[14]  = gl.createProgram();
gl.attachShader(this.prog[14], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[14] ));
gl.attachShader(this.prog[14], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[14] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[14], 0, "aPos");
gl.bindAttribLocation(this.prog[14], 1, "aCol");
gl.linkProgram(this.prog[14]);
texts = [
"x3"
];
texinfo = drawTextToCanvas(texts, 1);
this.ofsLoc[14] = gl.getAttribLocation(this.prog[14], "aOfs");
this.texture[14] = gl.createTexture();
this.texLoc[14] = gl.getAttribLocation(this.prog[14], "aTexcoord");
this.sampler[14] = gl.getUniformLocation(this.prog[14],"uSampler");
this.handleLoadedTexture(14);
this.offsets[14]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:5, tofs:3, stride:7};
v=new Float32Array([
-0.678, -0.678, 0, 0, -0.5, 0.5, 0.5,
-0.678, -0.678, 0, 1, -0.5, 0.5, 0.5,
-0.678, -0.678, 0, 1, 1.5, 0.5, 0.5,
-0.678, -0.678, 0, 0, 1.5, 0.5, 0.5
]);
for (i=0; i<1; i++)
for (j=0; j<4; j++) {
ind = this.offsets[14].stride*(4*i + j) + this.offsets[14].tofs;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i];
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip -
v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
this.values[14] = v;
f=new Uint16Array([
0, 1, 2, 0, 2, 3
]);
this.buf[14] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[14]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[14], gl.STATIC_DRAW);
this.ibuf[14] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[14]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
this.mvMatLoc[14] = gl.getUniformLocation(this.prog[14],"mvMatrix");
this.prMatLoc[14] = gl.getUniformLocation(this.prog[14],"prMatrix");
this.textScaleLoc[14] = gl.getUniformLocation(this.prog[14],"textScale");
// ****** planes object 15 ******
this.flags[15] = 67;
this.vshaders[15] = "   /* ****** planes object 15 vertex shader ****** */\n    attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   attribute vec3 aNorm;\n uniform mat4 normMatrix;\n  varying vec3 vNormal;\n void main(void) {\n   vPosition = mvMatrix * vec4(aPos, 1.);\n    gl_Position = prMatrix * vPosition;\n   vCol = aCol;\n      vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n    }";
this.fshaders[15] = "   /* ****** planes object 15 fragment shader ****** */\n  #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   varying vec3 vNormal;\n void main(void) {\n   vec3 eye = normalize(-vPosition.xyz);\n     const vec3 emission = vec3(0., 0., 0.);\n   const vec3 ambient1 = vec3(0., 0., 0.);\n   const vec3 specular1 = vec3(1., 1., 1.);// light*material\n     const float shininess1 = 50.;\n     vec4 colDiff1 = vec4(vCol.rgb * vec3(1., 1., 1.), vCol.a);\n    const vec3 lightDir1 = vec3(0., 0., 1.);\n      vec3 halfVec1 = normalize(lightDir1 + eye);\n      vec4 lighteffect = vec4(emission, 0.);\n     vec3 n = normalize(vNormal);\n      n = -faceforward(n, n, eye);\n      vec3 col1 = ambient1;\n     float nDotL1 = dot(n, lightDir1);\n     col1 = col1 + max(nDotL1, 0.) * colDiff1.rgb;\n     col1 = col1 + pow(max(dot(halfVec1, n), 0.), shininess1) * specular1;\n     lighteffect = lighteffect + vec4(col1, colDiff1.a);\n   gl_FragColor = lighteffect;\n }";
this.prog[15]  = gl.createProgram();
gl.attachShader(this.prog[15], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[15] ));
gl.attachShader(this.prog[15], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[15] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[15], 0, "aPos");
gl.bindAttribLocation(this.prog[15], 1, "aCol");
gl.linkProgram(this.prog[15]);
this.offsets[15]={vofs:0, cofs:3, nofs:7, radofs:-1, oofs:-1, tofs:-1, stride:10};
v=new Float32Array([
4, 0, 0, 1, 0, 0, 0.4980392, 2, 1, -1,
3.5, 4, 3, 1, 0, 0, 0.4980392, 2, 1, -1,
4, 3, 3, 1, 0, 0, 0.4980392, 2, 1, -1,
4, 0, 0, 1, 0, 0, 0.4980392, 2, 1, -1,
0.5, 4, -3, 1, 0, 0, 0.4980392, 2, 1, -1,
3.5, 4, 3, 1, 0, 0, 0.4980392, 2, 1, -1,
4, 0, 0, 1, 0, 0, 0.4980392, 2, 1, -1,
2.5, 0, -3, 1, 0, 0, 0.4980392, 2, 1, -1,
0.5, 4, -3, 1, 0, 0, 0.4980392, 2, 1, -1,
NaN, NaN, NaN, 1, 0, 0, 0.4980392, 2, 1, -1,
NaN, NaN, NaN, 1, 0, 0, 0.4980392, 2, 1, -1,
NaN, NaN, NaN, 1, 0, 0, 0.4980392, 2, 1, -1,
4, 0, 0.5, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
4, 4, 2.5, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
0.3333333, 4, -3, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
4, 0, 0.5, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
0.3333333, 4, -3, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
1.666667, 0, -3, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
NaN, NaN, NaN, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
NaN, NaN, NaN, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
NaN, NaN, NaN, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
NaN, NaN, NaN, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
NaN, NaN, NaN, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
NaN, NaN, NaN, 0, 0.8039216, 0, 0.4980392, -3, -1, 2,
0, 0, -1.5, 0, 0, 1, 0.4980392, -2, 1, 2,
4, 0, 2.5, 0, 0, 1, 0.4980392, -2, 1, 2,
4, 4, 0.5, 0, 0, 1, 0.4980392, -2, 1, 2,
0, 0, -1.5, 0, 0, 1, 0.4980392, -2, 1, 2,
4, 4, 0.5, 0, 0, 1, 0.4980392, -2, 1, 2,
0.5, 4, -3, 0, 0, 1, 0.4980392, -2, 1, 2,
0, 0, -1.5, 0, 0, 1, 0.4980392, -2, 1, 2,
0.5, 4, -3, 0, 0, 1, 0.4980392, -2, 1, 2,
0, 3, -3, 0, 0, 1, 0.4980392, -2, 1, 2,
NaN, NaN, NaN, 0, 0, 1, 0.4980392, -2, 1, 2,
NaN, NaN, NaN, 0, 0, 1, 0.4980392, -2, 1, 2,
NaN, NaN, NaN, 0, 0, 1, 0.4980392, -2, 1, 2
]);
this.values[15] = v;
this.normLoc[15] = gl.getAttribLocation(this.prog[15], "aNorm");
this.buf[15] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[15]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[15], gl.STATIC_DRAW);
this.mvMatLoc[15] = gl.getUniformLocation(this.prog[15],"mvMatrix");
this.prMatLoc[15] = gl.getUniformLocation(this.prog[15],"prMatrix");
this.normMatLoc[15] = gl.getUniformLocation(this.prog[15],"normMatrix");
// ****** spheres object 16 ******
this.flags[16] = 3;
this.vshaders[16] = "   /* ****** spheres object 16 vertex shader ****** */\n   attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   attribute vec3 aNorm;\n uniform mat4 normMatrix;\n  varying vec3 vNormal;\n void main(void) {\n   vPosition = mvMatrix * vec4(aPos, 1.);\n    gl_Position = prMatrix * vPosition;\n   vCol = aCol;\n      vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n    }";
this.fshaders[16] = "   /* ****** spheres object 16 fragment shader ****** */\n #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   varying vec3 vNormal;\n void main(void) {\n   vec3 eye = normalize(-vPosition.xyz);\n     const vec3 emission = vec3(0., 0., 0.);\n   const vec3 ambient1 = vec3(0., 0., 0.);\n   const vec3 specular1 = vec3(1., 1., 1.);// light*material\n     const float shininess1 = 50.;\n     vec4 colDiff1 = vec4(vCol.rgb * vec3(1., 1., 1.), vCol.a);\n    const vec3 lightDir1 = vec3(0., 0., 1.);\n      vec3 halfVec1 = normalize(lightDir1 + eye);\n      vec4 lighteffect = vec4(emission, 0.);\n     vec3 n = normalize(vNormal);\n      n = -faceforward(n, n, eye);\n      vec3 col1 = ambient1;\n     float nDotL1 = dot(n, lightDir1);\n     col1 = col1 + max(nDotL1, 0.) * colDiff1.rgb;\n     col1 = col1 + pow(max(dot(halfVec1, n), 0.), shininess1) * specular1;\n     lighteffect = lighteffect + vec4(col1, colDiff1.a);\n   gl_FragColor = lighteffect;\n }";
this.prog[16]  = gl.createProgram();
gl.attachShader(this.prog[16], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[16] ));
gl.attachShader(this.prog[16], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[16] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[16], 0, "aPos");
gl.bindAttribLocation(this.prog[16], 1, "aCol");
gl.linkProgram(this.prog[16]);
this.offsets[16]={vofs:0, cofs:-1, nofs:-1, radofs:3, oofs:-1, tofs:-1, stride:4};
v=new Float32Array([
2, 3, -1, 0.2
]);
this.values[16] = v;
this.normLoc[16] = gl.getAttribLocation(this.prog[16], "aNorm");
this.mvMatLoc[16] = gl.getUniformLocation(this.prog[16],"mvMatrix");
this.prMatLoc[16] = gl.getUniformLocation(this.prog[16],"prMatrix");
this.normMatLoc[16] = gl.getUniformLocation(this.prog[16],"normMatrix");
// ****** lines object 17 ******
this.flags[17] = 128;
this.vshaders[17] = "   /* ****** lines object 17 vertex shader ****** */\n attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   void main(void) {\n   vPosition = mvMatrix * vec4(aPos, 1.);\n    gl_Position = prMatrix * vPosition;\n   vCol = aCol;\n    }";
this.fshaders[17] = "   /* ****** lines object 17 fragment shader ****** */\n   #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   gl_FragColor = lighteffect;\n }";
this.prog[17]  = gl.createProgram();
gl.attachShader(this.prog[17], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[17] ));
gl.attachShader(this.prog[17], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[17] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[17], 0, "aPos");
gl.bindAttribLocation(this.prog[17], 1, "aCol");
gl.linkProgram(this.prog[17]);
this.offsets[17]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1, tofs:-1, stride:3};
v=new Float32Array([
0, -0.06, -3.09,
4, -0.06, -3.09,
0, -0.06, -3.09,
0, -0.163, -3.2445,
1, -0.06, -3.09,
1, -0.163, -3.2445,
2, -0.06, -3.09,
2, -0.163, -3.2445,
3, -0.06, -3.09,
3, -0.163, -3.2445,
4, -0.06, -3.09,
4, -0.163, -3.2445
]);
this.values[17] = v;
this.buf[17] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[17]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[17], gl.STATIC_DRAW);
this.mvMatLoc[17] = gl.getUniformLocation(this.prog[17],"mvMatrix");
this.prMatLoc[17] = gl.getUniformLocation(this.prog[17],"prMatrix");
// ****** text object 18 ******
this.flags[18] = 40;
this.vshaders[18] = "   /* ****** text object 18 vertex shader ****** */\n  attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   attribute vec2 aTexcoord;\n varying vec2 vTexcoord;\n   uniform vec2 textScale;\n   attribute vec2 aOfs;\n  void main(void) {\n   vCol = aCol;\n      vTexcoord = aTexcoord;\n    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n      pos = pos/pos.w;\n      gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n    }";
this.fshaders[18] = "   /* ****** text object 18 fragment shader ****** */\n    #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   varying vec2 vTexcoord;\n   uniform sampler2D uSampler;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n   if (textureColor.a < 0.1)\n       discard;\n    else\n        gl_FragColor = textureColor;\n  }";
this.prog[18]  = gl.createProgram();
gl.attachShader(this.prog[18], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[18] ));
gl.attachShader(this.prog[18], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[18] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[18], 0, "aPos");
gl.bindAttribLocation(this.prog[18], 1, "aCol");
gl.linkProgram(this.prog[18]);
texts = [
"0",
"1",
"2",
"3",
"4"
];
texinfo = drawTextToCanvas(texts, 1);
this.ofsLoc[18] = gl.getAttribLocation(this.prog[18], "aOfs");
this.texture[18] = gl.createTexture();
this.texLoc[18] = gl.getAttribLocation(this.prog[18], "aTexcoord");
this.sampler[18] = gl.getUniformLocation(this.prog[18],"uSampler");
this.handleLoadedTexture(18);
this.offsets[18]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:5, tofs:3, stride:7};
v=new Float32Array([
0, -0.369, -3.5535, 0, -0.5, 0.5, 0.5,
0, -0.369, -3.5535, 1, -0.5, 0.5, 0.5,
0, -0.369, -3.5535, 1, 1.5, 0.5, 0.5,
0, -0.369, -3.5535, 0, 1.5, 0.5, 0.5,
1, -0.369, -3.5535, 0, -0.5, 0.5, 0.5,
1, -0.369, -3.5535, 1, -0.5, 0.5, 0.5,
1, -0.369, -3.5535, 1, 1.5, 0.5, 0.5,
1, -0.369, -3.5535, 0, 1.5, 0.5, 0.5,
2, -0.369, -3.5535, 0, -0.5, 0.5, 0.5,
2, -0.369, -3.5535, 1, -0.5, 0.5, 0.5,
2, -0.369, -3.5535, 1, 1.5, 0.5, 0.5,
2, -0.369, -3.5535, 0, 1.5, 0.5, 0.5,
3, -0.369, -3.5535, 0, -0.5, 0.5, 0.5,
3, -0.369, -3.5535, 1, -0.5, 0.5, 0.5,
3, -0.369, -3.5535, 1, 1.5, 0.5, 0.5,
3, -0.369, -3.5535, 0, 1.5, 0.5, 0.5,
4, -0.369, -3.5535, 0, -0.5, 0.5, 0.5,
4, -0.369, -3.5535, 1, -0.5, 0.5, 0.5,
4, -0.369, -3.5535, 1, 1.5, 0.5, 0.5,
4, -0.369, -3.5535, 0, 1.5, 0.5, 0.5
]);
for (i=0; i<5; i++)
for (j=0; j<4; j++) {
ind = this.offsets[18].stride*(4*i + j) + this.offsets[18].tofs;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i];
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip -
v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
this.values[18] = v;
f=new Uint16Array([
0, 1, 2, 0, 2, 3,
4, 5, 6, 4, 6, 7,
8, 9, 10, 8, 10, 11,
12, 13, 14, 12, 14, 15,
16, 17, 18, 16, 18, 19
]);
this.buf[18] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[18]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[18], gl.STATIC_DRAW);
this.ibuf[18] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[18]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
this.mvMatLoc[18] = gl.getUniformLocation(this.prog[18],"mvMatrix");
this.prMatLoc[18] = gl.getUniformLocation(this.prog[18],"prMatrix");
this.textScaleLoc[18] = gl.getUniformLocation(this.prog[18],"textScale");
// ****** lines object 19 ******
this.flags[19] = 128;
this.vshaders[19] = "   /* ****** lines object 19 vertex shader ****** */\n attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   void main(void) {\n   vPosition = mvMatrix * vec4(aPos, 1.);\n    gl_Position = prMatrix * vPosition;\n   vCol = aCol;\n    }";
this.fshaders[19] = "   /* ****** lines object 19 fragment shader ****** */\n   #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   gl_FragColor = lighteffect;\n }";
this.prog[19]  = gl.createProgram();
gl.attachShader(this.prog[19], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[19] ));
gl.attachShader(this.prog[19], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[19] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[19], 0, "aPos");
gl.bindAttribLocation(this.prog[19], 1, "aCol");
gl.linkProgram(this.prog[19]);
this.offsets[19]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1, tofs:-1, stride:3};
v=new Float32Array([
-0.06, 0, -3.09,
-0.06, 4, -3.09,
-0.06, 0, -3.09,
-0.163, 0, -3.2445,
-0.06, 1, -3.09,
-0.163, 1, -3.2445,
-0.06, 2, -3.09,
-0.163, 2, -3.2445,
-0.06, 3, -3.09,
-0.163, 3, -3.2445,
-0.06, 4, -3.09,
-0.163, 4, -3.2445
]);
this.values[19] = v;
this.buf[19] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[19]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[19], gl.STATIC_DRAW);
this.mvMatLoc[19] = gl.getUniformLocation(this.prog[19],"mvMatrix");
this.prMatLoc[19] = gl.getUniformLocation(this.prog[19],"prMatrix");
// ****** text object 20 ******
this.flags[20] = 40;
this.vshaders[20] = "   /* ****** text object 20 vertex shader ****** */\n  attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   attribute vec2 aTexcoord;\n varying vec2 vTexcoord;\n   uniform vec2 textScale;\n   attribute vec2 aOfs;\n  void main(void) {\n   vCol = aCol;\n      vTexcoord = aTexcoord;\n    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n      pos = pos/pos.w;\n      gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n    }";
this.fshaders[20] = "   /* ****** text object 20 fragment shader ****** */\n    #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   varying vec2 vTexcoord;\n   uniform sampler2D uSampler;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n   if (textureColor.a < 0.1)\n       discard;\n    else\n        gl_FragColor = textureColor;\n  }";
this.prog[20]  = gl.createProgram();
gl.attachShader(this.prog[20], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[20] ));
gl.attachShader(this.prog[20], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[20] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[20], 0, "aPos");
gl.bindAttribLocation(this.prog[20], 1, "aCol");
gl.linkProgram(this.prog[20]);
texts = [
"0",
"1",
"2",
"3",
"4"
];
texinfo = drawTextToCanvas(texts, 1);
this.ofsLoc[20] = gl.getAttribLocation(this.prog[20], "aOfs");
this.texture[20] = gl.createTexture();
this.texLoc[20] = gl.getAttribLocation(this.prog[20], "aTexcoord");
this.sampler[20] = gl.getUniformLocation(this.prog[20],"uSampler");
this.handleLoadedTexture(20);
this.offsets[20]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:5, tofs:3, stride:7};
v=new Float32Array([
-0.369, 0, -3.5535, 0, -0.5, 0.5, 0.5,
-0.369, 0, -3.5535, 1, -0.5, 0.5, 0.5,
-0.369, 0, -3.5535, 1, 1.5, 0.5, 0.5,
-0.369, 0, -3.5535, 0, 1.5, 0.5, 0.5,
-0.369, 1, -3.5535, 0, -0.5, 0.5, 0.5,
-0.369, 1, -3.5535, 1, -0.5, 0.5, 0.5,
-0.369, 1, -3.5535, 1, 1.5, 0.5, 0.5,
-0.369, 1, -3.5535, 0, 1.5, 0.5, 0.5,
-0.369, 2, -3.5535, 0, -0.5, 0.5, 0.5,
-0.369, 2, -3.5535, 1, -0.5, 0.5, 0.5,
-0.369, 2, -3.5535, 1, 1.5, 0.5, 0.5,
-0.369, 2, -3.5535, 0, 1.5, 0.5, 0.5,
-0.369, 3, -3.5535, 0, -0.5, 0.5, 0.5,
-0.369, 3, -3.5535, 1, -0.5, 0.5, 0.5,
-0.369, 3, -3.5535, 1, 1.5, 0.5, 0.5,
-0.369, 3, -3.5535, 0, 1.5, 0.5, 0.5,
-0.369, 4, -3.5535, 0, -0.5, 0.5, 0.5,
-0.369, 4, -3.5535, 1, -0.5, 0.5, 0.5,
-0.369, 4, -3.5535, 1, 1.5, 0.5, 0.5,
-0.369, 4, -3.5535, 0, 1.5, 0.5, 0.5
]);
for (i=0; i<5; i++)
for (j=0; j<4; j++) {
ind = this.offsets[20].stride*(4*i + j) + this.offsets[20].tofs;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i];
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip -
v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
this.values[20] = v;
f=new Uint16Array([
0, 1, 2, 0, 2, 3,
4, 5, 6, 4, 6, 7,
8, 9, 10, 8, 10, 11,
12, 13, 14, 12, 14, 15,
16, 17, 18, 16, 18, 19
]);
this.buf[20] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[20]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[20], gl.STATIC_DRAW);
this.ibuf[20] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[20]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
this.mvMatLoc[20] = gl.getUniformLocation(this.prog[20],"mvMatrix");
this.prMatLoc[20] = gl.getUniformLocation(this.prog[20],"prMatrix");
this.textScaleLoc[20] = gl.getUniformLocation(this.prog[20],"textScale");
// ****** lines object 21 ******
this.flags[21] = 128;
this.vshaders[21] = "   /* ****** lines object 21 vertex shader ****** */\n attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   void main(void) {\n   vPosition = mvMatrix * vec4(aPos, 1.);\n    gl_Position = prMatrix * vPosition;\n   vCol = aCol;\n    }";
this.fshaders[21] = "   /* ****** lines object 21 fragment shader ****** */\n   #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   gl_FragColor = lighteffect;\n }";
this.prog[21]  = gl.createProgram();
gl.attachShader(this.prog[21], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[21] ));
gl.attachShader(this.prog[21], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[21] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[21], 0, "aPos");
gl.bindAttribLocation(this.prog[21], 1, "aCol");
gl.linkProgram(this.prog[21]);
this.offsets[21]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1, tofs:-1, stride:3};
v=new Float32Array([
-0.06, -0.06, -3,
-0.06, -0.06, 3,
-0.06, -0.06, -3,
-0.163, -0.163, -3,
-0.06, -0.06, -2,
-0.163, -0.163, -2,
-0.06, -0.06, -1,
-0.163, -0.163, -1,
-0.06, -0.06, 0,
-0.163, -0.163, 0,
-0.06, -0.06, 1,
-0.163, -0.163, 1,
-0.06, -0.06, 2,
-0.163, -0.163, 2,
-0.06, -0.06, 3,
-0.163, -0.163, 3
]);
this.values[21] = v;
this.buf[21] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[21]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[21], gl.STATIC_DRAW);
this.mvMatLoc[21] = gl.getUniformLocation(this.prog[21],"mvMatrix");
this.prMatLoc[21] = gl.getUniformLocation(this.prog[21],"prMatrix");
// ****** text object 22 ******
this.flags[22] = 40;
this.vshaders[22] = "   /* ****** text object 22 vertex shader ****** */\n  attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   attribute vec2 aTexcoord;\n varying vec2 vTexcoord;\n   uniform vec2 textScale;\n   attribute vec2 aOfs;\n  void main(void) {\n   vCol = aCol;\n      vTexcoord = aTexcoord;\n    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n      pos = pos/pos.w;\n      gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n    }";
this.fshaders[22] = "   /* ****** text object 22 fragment shader ****** */\n    #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   varying vec2 vTexcoord;\n   uniform sampler2D uSampler;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n   if (textureColor.a < 0.1)\n       discard;\n    else\n        gl_FragColor = textureColor;\n  }";
this.prog[22]  = gl.createProgram();
gl.attachShader(this.prog[22], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[22] ));
gl.attachShader(this.prog[22], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[22] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[22], 0, "aPos");
gl.bindAttribLocation(this.prog[22], 1, "aCol");
gl.linkProgram(this.prog[22]);
texts = [
"-3",
"-2",
"-1",
"0",
"1",
"2",
"3"
];
texinfo = drawTextToCanvas(texts, 1);
this.ofsLoc[22] = gl.getAttribLocation(this.prog[22], "aOfs");
this.texture[22] = gl.createTexture();
this.texLoc[22] = gl.getAttribLocation(this.prog[22], "aTexcoord");
this.sampler[22] = gl.getUniformLocation(this.prog[22],"uSampler");
this.handleLoadedTexture(22);
this.offsets[22]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:5, tofs:3, stride:7};
v=new Float32Array([
-0.369, -0.369, -3, 0, -0.5, 0.5, 0.5,
-0.369, -0.369, -3, 1, -0.5, 0.5, 0.5,
-0.369, -0.369, -3, 1, 1.5, 0.5, 0.5,
-0.369, -0.369, -3, 0, 1.5, 0.5, 0.5,
-0.369, -0.369, -2, 0, -0.5, 0.5, 0.5,
-0.369, -0.369, -2, 1, -0.5, 0.5, 0.5,
-0.369, -0.369, -2, 1, 1.5, 0.5, 0.5,
-0.369, -0.369, -2, 0, 1.5, 0.5, 0.5,
-0.369, -0.369, -1, 0, -0.5, 0.5, 0.5,
-0.369, -0.369, -1, 1, -0.5, 0.5, 0.5,
-0.369, -0.369, -1, 1, 1.5, 0.5, 0.5,
-0.369, -0.369, -1, 0, 1.5, 0.5, 0.5,
-0.369, -0.369, 0, 0, -0.5, 0.5, 0.5,
-0.369, -0.369, 0, 1, -0.5, 0.5, 0.5,
-0.369, -0.369, 0, 1, 1.5, 0.5, 0.5,
-0.369, -0.369, 0, 0, 1.5, 0.5, 0.5,
-0.369, -0.369, 1, 0, -0.5, 0.5, 0.5,
-0.369, -0.369, 1, 1, -0.5, 0.5, 0.5,
-0.369, -0.369, 1, 1, 1.5, 0.5, 0.5,
-0.369, -0.369, 1, 0, 1.5, 0.5, 0.5,
-0.369, -0.369, 2, 0, -0.5, 0.5, 0.5,
-0.369, -0.369, 2, 1, -0.5, 0.5, 0.5,
-0.369, -0.369, 2, 1, 1.5, 0.5, 0.5,
-0.369, -0.369, 2, 0, 1.5, 0.5, 0.5,
-0.369, -0.369, 3, 0, -0.5, 0.5, 0.5,
-0.369, -0.369, 3, 1, -0.5, 0.5, 0.5,
-0.369, -0.369, 3, 1, 1.5, 0.5, 0.5,
-0.369, -0.369, 3, 0, 1.5, 0.5, 0.5
]);
for (i=0; i<7; i++)
for (j=0; j<4; j++) {
ind = this.offsets[22].stride*(4*i + j) + this.offsets[22].tofs;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i];
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip -
v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
this.values[22] = v;
f=new Uint16Array([
0, 1, 2, 0, 2, 3,
4, 5, 6, 4, 6, 7,
8, 9, 10, 8, 10, 11,
12, 13, 14, 12, 14, 15,
16, 17, 18, 16, 18, 19,
20, 21, 22, 20, 22, 23,
24, 25, 26, 24, 26, 27
]);
this.buf[22] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[22]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[22], gl.STATIC_DRAW);
this.ibuf[22] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[22]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
this.mvMatLoc[22] = gl.getUniformLocation(this.prog[22],"mvMatrix");
this.prMatLoc[22] = gl.getUniformLocation(this.prog[22],"prMatrix");
this.textScaleLoc[22] = gl.getUniformLocation(this.prog[22],"textScale");
// ****** lines object 23 ******
this.flags[23] = 128;
this.vshaders[23] = "   /* ****** lines object 23 vertex shader ****** */\n attribute vec3 aPos;\n  attribute vec4 aCol;\n  uniform mat4 mvMatrix;\n    uniform mat4 prMatrix;\n    varying vec4 vCol;\n    varying vec4 vPosition;\n   void main(void) {\n   vPosition = mvMatrix * vec4(aPos, 1.);\n    gl_Position = prMatrix * vPosition;\n   vCol = aCol;\n    }";
this.fshaders[23] = "   /* ****** lines object 23 fragment shader ****** */\n   #ifdef GL_ES\n  precision highp float;\n    #endif\n    varying vec4 vCol; // carries alpha\n   varying vec4 vPosition;\n   void main(void) {\n      vec4 colDiff = vCol;\n   vec4 lighteffect = colDiff;\n   gl_FragColor = lighteffect;\n }";
this.prog[23]  = gl.createProgram();
gl.attachShader(this.prog[23], this.getShader( gl, gl.VERTEX_SHADER, this.vshaders[23] ));
gl.attachShader(this.prog[23], this.getShader( gl, gl.FRAGMENT_SHADER, this.fshaders[23] ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(this.prog[23], 0, "aPos");
gl.bindAttribLocation(this.prog[23], 1, "aCol");
gl.linkProgram(this.prog[23]);
this.offsets[23]={vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1, tofs:-1, stride:3};
v=new Float32Array([
-0.06, -0.06, -3.09,
-0.06, 4.06, -3.09,
-0.06, -0.06, 3.09,
-0.06, 4.06, 3.09,
-0.06, -0.06, -3.09,
-0.06, -0.06, 3.09,
-0.06, 4.06, -3.09,
-0.06, 4.06, 3.09,
-0.06, -0.06, -3.09,
4.06, -0.06, -3.09,
-0.06, -0.06, 3.09,
4.06, -0.06, 3.09,
-0.06, 4.06, -3.09,
4.06, 4.06, -3.09,
-0.06, 4.06, 3.09,
4.06, 4.06, 3.09,
4.06, -0.06, -3.09,
4.06, 4.06, -3.09,
4.06, -0.06, 3.09,
4.06, 4.06, 3.09,
4.06, -0.06, -3.09,
4.06, -0.06, 3.09,
4.06, 4.06, -3.09,
4.06, 4.06, 3.09
]);
this.values[23] = v;
this.buf[23] = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[23]);
gl.bufferData(gl.ARRAY_BUFFER, this.values[23], gl.STATIC_DRAW);
this.mvMatLoc[23] = gl.getUniformLocation(this.prog[23],"mvMatrix");
this.prMatLoc[23] = gl.getUniformLocation(this.prog[23],"prMatrix");
gl.enable(gl.DEPTH_TEST);
gl.depthFunc(gl.LEQUAL);
gl.clearDepth(1.0);
gl.clearColor(1,1,1,1);
var drag  = 0;
this.drawScene = function() {
gl.depthMask(true);
gl.disable(gl.BLEND);
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
this.drawFns[1].call(this, 1);
gl.flush();
};
// ****** clipplanes object 8 *******
this.drawFns[8] = function(id, clipplanes) {
var i;
this.IMVClip[id] = [];
this.IMVClip[id][0] = this.multMV(this.invMatrix, this.vClipplane[id].slice(0, 4));
this.IMVClip[id][1] = this.multMV(this.invMatrix, this.vClipplane[id].slice(4, 8));
this.IMVClip[id][2] = this.multMV(this.invMatrix, this.vClipplane[id].slice(8, 12));
this.IMVClip[id][3] = this.multMV(this.invMatrix, this.vClipplane[id].slice(12, 16));
this.IMVClip[id][4] = this.multMV(this.invMatrix, this.vClipplane[id].slice(16, 20));
this.IMVClip[id][5] = this.multMV(this.invMatrix, this.vClipplane[id].slice(20, 24));
};
this.clipFns[8] = function(id, objid, count) {
for (i=0; i<6; i++)
gl.uniform4fv(this.clipLoc[objid][count + i], this.IMVClip[id][i]);
return(count + 6);
};
// ****** lines object 9 *******
this.drawFns[9] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawArrays(gl.LINES, 0, 4);
};
// ****** lines object 10 *******
this.drawFns[10] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawArrays(gl.LINES, 0, 4);
};
// ****** text object 12 *******
this.drawFns[12] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.uniform2f( this.textScaleLoc[id], 0.75/this.vp[2], 0.75/this.vp[3]);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( this.texLoc[id] );
gl.vertexAttribPointer(this.texLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, this.texture[id]);
gl.uniform1i( this.sampler[id], 0);
gl.enableVertexAttribArray( this.ofsLoc[id] );
gl.vertexAttribPointer(this.ofsLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].oofs);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
};
// ****** text object 13 *******
this.drawFns[13] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.uniform2f( this.textScaleLoc[id], 0.75/this.vp[2], 0.75/this.vp[3]);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( this.texLoc[id] );
gl.vertexAttribPointer(this.texLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, this.texture[id]);
gl.uniform1i( this.sampler[id], 0);
gl.enableVertexAttribArray( this.ofsLoc[id] );
gl.vertexAttribPointer(this.ofsLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].oofs);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
};
// ****** text object 14 *******
this.drawFns[14] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.uniform2f( this.textScaleLoc[id], 0.75/this.vp[2], 0.75/this.vp[3]);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( this.texLoc[id] );
gl.vertexAttribPointer(this.texLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, this.texture[id]);
gl.uniform1i( this.sampler[id], 0);
gl.enableVertexAttribArray( this.ofsLoc[id] );
gl.vertexAttribPointer(this.ofsLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].oofs);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
};
// ****** planes object 15 *******
this.drawFns[15] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.uniformMatrix4fv( this.normMatLoc[id], false, new Float32Array(normMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.enableVertexAttribArray( colLoc );
gl.vertexAttribPointer(colLoc, 4, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].cofs);
gl.enableVertexAttribArray( this.normLoc[id] );
gl.vertexAttribPointer(this.normLoc[id], 3, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].nofs);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawArrays(gl.TRIANGLES, 0, 36);
};
// ****** spheres object 16 *******
this.drawFns[16] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, sphereBuf);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphereIbuf);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.uniformMatrix4fv( this.normMatLoc[id], false, new Float32Array(normMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 12,  0);
gl.enableVertexAttribArray(this.normLoc[id] );
gl.vertexAttribPointer(this.normLoc[id],  3, gl.FLOAT, false, 12,  0);
gl.disableVertexAttribArray( colLoc );
var sphereNorm = new CanvasMatrix4();
sphereNorm.scale(1.190238, 1.190238, 0.793492);
sphereNorm.multRight(normMatrix);
gl.uniformMatrix4fv( this.normMatLoc[id], false, new Float32Array(sphereNorm.getAsArray()) );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1);
for (i = 0; i < 1; i++) {
var sphereMV = new CanvasMatrix4();
var baseofs = i*plotEqn1rgl.offsets[id].stride;
var ofs = baseofs + this.offsets[id].radofs;
var scale = this.values[id][ofs];
sphereMV.scale(0.840168*scale, 0.840168*scale, 1.260252*scale);
sphereMV.translate(this.values[id][baseofs],
this.values[id][baseofs+1],
this.values[id][baseofs+2]);
sphereMV.multRight(this.mvMatrix);
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(sphereMV.getAsArray()) );
gl.drawElements(gl.TRIANGLES, 384, gl.UNSIGNED_SHORT, 0);
}
};
// ****** lines object 17 *******
this.drawFns[17] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawArrays(gl.LINES, 0, 12);
};
// ****** text object 18 *******
this.drawFns[18] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.uniform2f( this.textScaleLoc[id], 0.75/this.vp[2], 0.75/this.vp[3]);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( this.texLoc[id] );
gl.vertexAttribPointer(this.texLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, this.texture[id]);
gl.uniform1i( this.sampler[id], 0);
gl.enableVertexAttribArray( this.ofsLoc[id] );
gl.vertexAttribPointer(this.ofsLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].oofs);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawElements(gl.TRIANGLES, 30, gl.UNSIGNED_SHORT, 0);
};
// ****** lines object 19 *******
this.drawFns[19] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawArrays(gl.LINES, 0, 12);
};
// ****** text object 20 *******
this.drawFns[20] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.uniform2f( this.textScaleLoc[id], 0.75/this.vp[2], 0.75/this.vp[3]);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( this.texLoc[id] );
gl.vertexAttribPointer(this.texLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, this.texture[id]);
gl.uniform1i( this.sampler[id], 0);
gl.enableVertexAttribArray( this.ofsLoc[id] );
gl.vertexAttribPointer(this.ofsLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].oofs);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawElements(gl.TRIANGLES, 30, gl.UNSIGNED_SHORT, 0);
};
// ****** lines object 21 *******
this.drawFns[21] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawArrays(gl.LINES, 0, 16);
};
// ****** text object 22 *******
this.drawFns[22] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.uniform2f( this.textScaleLoc[id], 0.75/this.vp[2], 0.75/this.vp[3]);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( this.texLoc[id] );
gl.vertexAttribPointer(this.texLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, this.texture[id]);
gl.uniform1i( this.sampler[id], 0);
gl.enableVertexAttribArray( this.ofsLoc[id] );
gl.vertexAttribPointer(this.ofsLoc[id], 2, gl.FLOAT, false, 4*this.offsets[id].stride, 4*this.offsets[id].oofs);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawElements(gl.TRIANGLES, 42, gl.UNSIGNED_SHORT, 0);
};
// ****** lines object 23 *******
this.drawFns[23] = function(id, clipplanes) {
var i;
gl.useProgram(this.prog[id]);
gl.bindBuffer(gl.ARRAY_BUFFER, this.buf[id]);
gl.uniformMatrix4fv( this.prMatLoc[id], false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( this.mvMatLoc[id], false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0;
for (i=0; i < clipplanes.length; i++)
clipcheck = this.clipFns[clipplanes[i]].call(this, clipplanes[i], id, clipcheck);
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 4*this.offsets[id].stride,  4*this.offsets[id].vofs);
gl.drawArrays(gl.LINES, 0, 24);
};
// ***** subscene 1 ****
this.drawFns[1] = function(id) {
var i;
this.vp = this.viewport[id];
gl.viewport(this.vp[0], this.vp[1], this.vp[2], this.vp[3]);
gl.scissor(this.vp[0], this.vp[1], this.vp[2], this.vp[3]);
gl.clearColor(1, 1, 1, 1);
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
this.prMatrix.makeIdentity();
var radius = 4.535416,
distance = 20.17858,
t = tan(this.FOV[1]*PI/360),
near = distance - radius,
far = distance + radius,
hlen = t*near,
aspect = this.vp[2]/this.vp[3],
z = this.zoom[1];
if (aspect > 1)
this.prMatrix.frustum(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.frustum(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
this.mvMatrix.makeIdentity();
this.mvMatrix.translate( -2, -2, -0 );
this.mvMatrix.scale( 1.190238, 1.190238, 0.793492 );
this.mvMatrix.multRight( plotEqn1rgl.userMatrix[1] );
this.mvMatrix.translate(-0, -0, -20.17858);
normMatrix.makeIdentity();
normMatrix.scale( 0.840168, 0.840168, 1.260252 );
normMatrix.multRight( plotEqn1rgl.userMatrix[1] );
var clipids = this.clipplanes[id];
if (clipids.length > 0) {
this.invMatrix = new CanvasMatrix4(this.mvMatrix);
this.invMatrix.invert();
for (i = 0; i < this.clipplanes[id].length; i++)
this.drawFns[clipids[i]].call(this, clipids[i]);
}
var subids = this.opaque[id];
for (i = 0; i < subids.length; i++)
this.drawFns[subids[i]].call(this, subids[i], clipids);
subids = this.transparent[id];
if (subids.length > 0) {
gl.depthMask(false);
gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA,
gl.ONE, gl.ONE);
gl.enable(gl.BLEND);
for (i = 0; i < subids.length; i++)
this.drawFns[subids[i]].call(this, subids[i], clipids);
}
subids = this.subscenes[id];
for (i = 0; i < subids.length; i++)
this.drawFns[subids[i]].call(this, subids[i]);
};
// ***** subscene 7 ****
this.drawFns[7] = function(id) {
var i;
this.vp = this.viewport[id];
gl.viewport(this.vp[0], this.vp[1], this.vp[2], this.vp[3]);
gl.scissor(this.vp[0], this.vp[1], this.vp[2], this.vp[3]);
this.prMatrix.makeIdentity();
var radius = 4.535416,
distance = 20.17858,
t = tan(this.FOV[1]*PI/360),
near = distance - radius,
far = distance + radius,
hlen = t*near,
aspect = this.vp[2]/this.vp[3],
z = this.zoom[1];
if (aspect > 1)
this.prMatrix.frustum(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.frustum(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
this.mvMatrix.makeIdentity();
this.mvMatrix.translate( -2, -2, -0 );
this.mvMatrix.scale( 1.190238, 1.190238, 0.793492 );
this.mvMatrix.multRight( plotEqn1rgl.userMatrix[1] );
this.mvMatrix.translate(-0, -0, -20.17858);
var clipids = this.clipplanes[id];
if (clipids.length > 0) {
this.invMatrix = new CanvasMatrix4(this.mvMatrix);
this.invMatrix.invert();
for (i = 0; i < this.clipplanes[id].length; i++)
this.drawFns[clipids[i]].call(this, clipids[i]);
}
var subids = this.opaque[id];
for (i = 0; i < subids.length; i++)
this.drawFns[subids[i]].call(this, subids[i], clipids);
subids = this.transparent[id];
if (subids.length > 0) {
gl.depthMask(false);
gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA,
gl.ONE, gl.ONE);
gl.enable(gl.BLEND);
for (i = 0; i < subids.length; i++)
this.drawFns[subids[i]].call(this, subids[i], clipids);
}
subids = this.subscenes[id];
for (i = 0; i < subids.length; i++)
this.drawFns[subids[i]].call(this, subids[i]);
};
this.drawScene();
var vpx0 = {
7: 0, 1: 0
};
var vpy0 = {
7: 0, 1: 0
};
var vpWidths = {
7: 504, 1: 504
};
var vpHeights = {
7: 504, 1: 504
};
var activeModel = {
7: 1, 1: 1
};
var activeProjection = {
7: 1, 1: 1
};
plotEqn1rgl.listeners = {
7: [ 1 ], 1: [ 1 ]
};
var whichSubscene = function(coords){
if (0 <= coords.x && coords.x <= 504 && 0 <= coords.y && coords.y <= 504) return(7);
if (0 <= coords.x && coords.x <= 504 && 0 <= coords.y && coords.y <= 504) return(1);
return(1);
};
var translateCoords = function(subsceneid, coords){
return {x:coords.x - vpx0[subsceneid], y:coords.y - vpy0[subsceneid]};
};
var vlen = function(v) {
return sqrt(v[0]*v[0] + v[1]*v[1] + v[2]*v[2]);
};
var xprod = function(a, b) {
return [a[1]*b[2] - a[2]*b[1],
a[2]*b[0] - a[0]*b[2],
a[0]*b[1] - a[1]*b[0]];
};
var screenToVector = function(x, y) {
var width = vpWidths[activeSubscene],
height = vpHeights[activeSubscene],
radius = max(width, height)/2.0,
cx = width/2.0,
cy = height/2.0,
px = (x-cx)/radius,
py = (y-cy)/radius,
plen = sqrt(px*px+py*py);
if (plen > 1.e-6) {
px = px/plen;
py = py/plen;
}
var angle = (SQRT2 - plen)/SQRT2*PI/2,
z = sin(angle),
zlen = sqrt(1.0 - z*z);
px = px * zlen;
py = py * zlen;
return [px, py, z];
};
var rotBase;
var trackballdown = function(x,y) {
rotBase = screenToVector(x, y);
var l = plotEqn1rgl.listeners[activeModel[activeSubscene]];
saveMat = {};
for (var i = 0; i < l.length; i++)
saveMat[l[i]] = new CanvasMatrix4(plotEqn1rgl.userMatrix[l[i]]);
};
var trackballmove = function(x,y) {
var rotCurrent = screenToVector(x,y),
dot = rotBase[0]*rotCurrent[0] +
rotBase[1]*rotCurrent[1] +
rotBase[2]*rotCurrent[2],
angle = acos( dot/vlen(rotBase)/vlen(rotCurrent) )*180.0/PI,
axis = xprod(rotBase, rotCurrent),
l = plotEqn1rgl.listeners[activeModel[activeSubscene]],
i;
for (i = 0; i < l.length; i++) {
plotEqn1rgl.userMatrix[l[i]].load(saveMat[l[i]]);
plotEqn1rgl.userMatrix[l[i]].rotate(angle, axis[0], axis[1], axis[2]);
}
plotEqn1rgl.drawScene();
};
var trackballend = 0;
var y0zoom = 0;
var zoom0 = 0;
var zoomdown = function(x, y) {
y0zoom = y;
zoom0 = {};
l = plotEqn1rgl.listeners[activeProjection[activeSubscene]];
for (var i = 0; i < l.length; i++)
zoom0[l[i]] = log(plotEqn1rgl.zoom[l[i]]);
};
var zoommove = function(x, y) {
l = plotEqn1rgl.listeners[activeProjection[activeSubscene]];
for (var i = 0; i < l.length; i++)
plotEqn1rgl.zoom[l[i]] = exp(zoom0[l[i]] + (y-y0zoom)/height);
plotEqn1rgl.drawScene();
};
var zoomend = 0;
var y0fov = 0;
var fov0 = 0;
var fovdown = function(x, y) {
y0fov = y;
fov0 = {};
l = plotEqn1rgl.listeners[activeProjection[activeSubscene]];
for (i = 0; i < l.length; i++)
fov0[l[i]] = plotEqn1rgl.FOV[l[i]];
};
var fovmove = function(x, y) {
l = plotEqn1rgl.listeners[activeProjection[activeSubscene]];
for (i = 0; i < l.length; i++)
plotEqn1rgl.FOV[l[i]] = max(1, min(179, fov0[l[i]] + 180*(y-y0fov)/height));
plotEqn1rgl.drawScene();
};
var fovend = 0;
var mousedown = [trackballdown, zoomdown, fovdown];
var mousemove = [trackballmove, zoommove, fovmove];
var mouseend = [trackballend, zoomend, fovend];
function relMouseCoords(event){
var totalOffsetX = 0,
totalOffsetY = 0,
currentElement = canvas;
do{
totalOffsetX += currentElement.offsetLeft;
totalOffsetY += currentElement.offsetTop;
currentElement = currentElement.offsetParent;
}
while(currentElement);
var canvasX = event.pageX - totalOffsetX,
canvasY = event.pageY - totalOffsetY;
return {x:canvasX, y:canvasY};
}
canvas.onmousedown = function ( ev ){
if (!ev.which) // Use w3c defns in preference to MS
switch (ev.button) {
case 0: ev.which = 1; break;
case 1:
case 4: ev.which = 2; break;
case 2: ev.which = 3;
}
drag = ev.which;
var f = mousedown[drag-1];
if (f) {
var coords = relMouseCoords(ev);
coords.y = height-coords.y;
activeSubscene = whichSubscene(coords);
coords = translateCoords(activeSubscene, coords);
f(coords.x, coords.y);
ev.preventDefault();
}
};
canvas.onmouseup = function ( ev ){
if ( drag === 0 ) return;
var f = mouseend[drag-1];
if (f)
f();
drag = 0;
};
canvas.onmouseout = canvas.onmouseup;
canvas.onmousemove = function ( ev ){
if ( drag === 0 ) return;
var f = mousemove[drag-1];
if (f) {
var coords = relMouseCoords(ev);
coords.y = height - coords.y;
coords = translateCoords(activeSubscene, coords);
f(coords.x, coords.y);
}
};
var wheelHandler = function(ev) {
var del = 1.1;
if (ev.shiftKey) del = 1.01;
var ds = ((ev.detail || ev.wheelDelta) > 0) ? del : (1 / del);
l = plotEqn1rgl.listeners[activeProjection[activeSubscene]];
for (var i = 0; i < l.length; i++)
plotEqn1rgl.zoom[l[i]] *= ds;
plotEqn1rgl.drawScene();
ev.preventDefault();
};
canvas.addEventListener("DOMMouseScroll", wheelHandler, false);
canvas.addEventListener("mousewheel", wheelHandler, false);
};
</script>

<p><canvas id="plotEqn1canvas" class="rglWebGL" width="1" height="1"></canvas></p>

<p id="plotEqn1debug">
<img src="data:image/png;base64,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" alt="plotEqn1snapshot" width=505/><br>
You must enable Javascript to view this page properly.</p>

<script>plotEqn1rgl.start();</script>

<h3>Three inconsistent equations</h3>

<pre><code class="r">A &lt;- matrix(c(1,  3, 1,
              1, -2, -2,
              2,  1, -1), 3, 3, byrow=TRUE)
colnames(A) &lt;- paste0(&#39;x&#39;, 1:3)
b &lt;- c(2, 3, 6)
showEqn(A, b)
</code></pre>

<pre><code>##      [,1]                      
## [1,] &quot;1*x1 + 3*x2 + 1*x3  =  2&quot;
## [2,] &quot;1*x1 - 2*x2 - 2*x3  =  3&quot;
## [3,] &quot;2*x1 + 1*x2 - 1*x3  =  6&quot;
</code></pre>

<p>Are the equations consistent? No.</p>

<pre><code class="r">c( R(A), R(cbind(A,b)) )          # show ranks
</code></pre>

<pre><code>## [1] 2 3
</code></pre>

<pre><code class="r">all.equal( R(A), R(cbind(A,b)) )  # consistent?
</code></pre>

<pre><code>## [1] &quot;Mean relative difference: 0.5&quot;
</code></pre>

</body>

</html>
