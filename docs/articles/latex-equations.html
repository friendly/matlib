<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>LaTeX Equations with latexMatrix, Eqn and matrix2latex ‚Ä¢ matlib</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LaTeX Equations with latexMatrix, Eqn and matrix2latex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">matlib</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.91</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data-beta.html">Vector Spaces of Least Squares and Linear Equations</a></li>
    <li><a class="dropdown-item" href="../articles/det-ex1.html">Properties of determinants</a></li>
    <li><a class="dropdown-item" href="../articles/det-ex2.html">Evaluation of determinants</a></li>
    <li><a class="dropdown-item" href="../articles/eigen-ex1.html">Eigenvalues and Eigenvectors: Properties</a></li>
    <li><a class="dropdown-item" href="../articles/eigen-ex2.html">Eigenvalues: Spectral Decomposition</a></li>
    <li><a class="dropdown-item" href="../articles/ginv.html">Generalized inverse</a></li>
    <li><a class="dropdown-item" href="../articles/gramreg.html">Gram-Schmidt Orthogonalization and Regression</a></li>
    <li><a class="dropdown-item" href="../articles/inv-3d.html">Linear transformations and matrix inverse in 3D</a></li>
    <li><a class="dropdown-item" href="../articles/inv-ex1.html">Inverse of a matrix</a></li>
    <li><a class="dropdown-item" href="../articles/inv-ex2.html">Matrix inversion by elementary row operations</a></li>
    <li><a class="dropdown-item" href="../articles/latex-equations.html">LaTeX Equations with latexMatrix, Eqn and matrix2latex</a></li>
    <li><a class="dropdown-item" href="../articles/linear-equations.html">Solving Linear Equations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/matlib/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>LaTeX Equations with latexMatrix, Eqn and matrix2latex</h1>
                        <h4 data-toc-skip class="author">Phil Chalmers,
John Fox, Michael Friendly</h4>
            
            <h4 data-toc-skip class="date">2024-08-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/matlib/blob/HEAD/vignettes/latex-equations.Rmd" class="external-link"><code>vignettes/latex-equations.Rmd</code></a></small>
      <div class="d-none name"><code>latex-equations.Rmd</code></div>
    </div>

    
    
<!-- --- -->
<!-- title: "LaTeX Equations with latexMatrix, Eqn and matrix2latex" -->
<!-- output:  -->
<!--     pdf_document: -->
<!--         extra_dependencies: ["amsmath"] -->
<!-- author: Phil Chalmers, Michael Friendly -->
<!-- date: "24 August, 2024" -->
<!-- --- -->
<p>LaTeX is the de facto standard for communication and publication in
scientific documents and it is very easy to typeset mathematical
expressions like Pythagoras‚Äô theorem,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">a^2 + b^2 = c^2</annotation></semantics></math>
(using <code>a^2 + b^2 = c^2</code>) once you learn the notation.
Writing equations with arrays, matrices and vectors is somewhat more
challenging. Many people rely on interactive LaTeX editors like <a
href="https://www.overleaf.com/">Overleaf</a>, <a
href="https://www.wiris.com/en/mathtype/">MathType</a>, or online
versions like <a href="https://latexeditor.lagrida.com/">Lagrida LaTeX
Equation Editor</a> that provide a menu-driven interface with fill-in
templates for matrices.</p>
<p>There are already some tools available in R for producing LaTeX
output for tables (<code>xtable::xtable()</code>), R objects
(<code>Hmisc::latex()</code>) and statistical models
(<code>equatiomatic::extract_eq()</code>).</p>
<p>The <code>matlib</code> package extends these, providing a collection
of functions that simplify using LaTeX notation for matrices, vectors
and equations in documentation and in writing:</p>
<ul>
<li><code>latexMatrix()</code>: Constructs the LaTeX code for a symbolic
matrix, whose elements are a symbol, with row and column subscripts.
<code>latexMatrix()</code> also supports matrices with numeric elements,
and the objects it produces may be used in various kinds of matrix
computations, both symbolic and numeric.</li>
<li><code>matrix2latex()</code>: Constructs the LaTeX code for a
symbolic matrix, whose elements are a symbol, with row and column
subscripts</li>
<li><code>showEqn()</code>: Shows what matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêÄ</mi><mo>,</mo><mi>ùêõ</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}, \mathbf{b}</annotation></semantics></math>
look like as the system of linear equations,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ùêÄ</mi><mi>ùê±</mi></mrow><mo>=</mo><mi>ùêõ</mi></mrow><annotation encoding="application/x-tex">\mathbf{A x} = \mathbf{b}</annotation></semantics></math>,
but written out as a set of equations.</li>
<li><code>Eqn()</code>: A wrapper to produce LaTeX expressions that can
be copied/pasted into documents or used directly in <code>.Rmd</code> or
<code>.qmd</code> documents to compile to equations.</li>
</ul>
<p>When used directly in R, they produce their output to the console
(using <code>cat()</code>). In a <code>.Rmd</code> or <code>.qmd</code>
document, use the chunk options: <code>results='asis', echo=FALSE</code>
so that <code>knitr</code> just outputs the text of the equations to the
document. The rendering of the equations is handled by <a
href="https://pandoc.org/"><code>pandoc</code></a>.</p>
<div id="using-latexmatrix-and-eqn" class="section level2">
<h2>Using <code>latexMatrix()</code> and <code>Eqn()</code></h2>
<p><code>latexMatrix()</code> constructs the LaTeX code for a symbolic
matrix, whose elements are a symbol, with row and column subscripts. For
example, by default (with no arguments) it produces the expression for a
matrix whose elements are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">x_{ij}</annotation></semantics></math>,
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>‚ãØ</mi><mo>,</mo><mi>n</mi><mo>;</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>‚ãØ</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">i = 1, 2, \cdots, n; j = 1, 2, \cdots,m</annotation></semantics></math>
in a LaTeX <code>\begin{pmatrix} ... \end{pmatrix}</code> environment
that looks like this:</p>
<pre><code>\begin{pmatrix} 
  x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1m} \\ 
  x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2m} \\ 
  \vdots &amp; \vdots &amp;        &amp; \vdots \\ 
  x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{nm} \\ 
\end{pmatrix}</code></pre>
<p>The code above appears in the console. To render this as a matrix in
a document, this must be wrapped in a display math environment, which is
provided by <code>Eqn()</code> and used in a code chunk with the
<code>results = 'asis'</code> option, giving:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">latexMatrix</span>() <span class="sc">|&gt;</span> <span class="fu">Eqn</span>()</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mrow><mn>1</mn><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mrow><mn>2</mn><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mrow><mi>n</mi><mi>m</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\begin{pmatrix} 
  x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1m} \\ 
  x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2m} \\ 
  \vdots &amp; \vdots &amp;        &amp; \vdots \\ 
  x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{nm} \\ 
\end{pmatrix}
\end{equation*}</annotation></semantics></math></p>
<p>For chunk output in a document, you will get a LaTeX error, ‚Äúmissing
$ inserted‚Äù if you forget to use <code>Eqn()</code> or otherwise fail to
make a math environment.</p>
<p>Some other examples:</p>
<ul>
<li>A
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>√ó</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">3 \times 3</annotation></semantics></math>
identity matrix with square brackets, specified as an equation with a
left-hand side
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêà</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\mathbf{I}_3</annotation></semantics></math>.
The first argument to <code>latexMatrix()</code> can be any numeric
matrix.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">Eqn</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">mathbf{I}_3 =&quot;</span>, <span class="fu">latexMatrix</span>(<span class="fu">diag</span>(<span class="dv">3</span>), <span class="at">matrix=</span><span class="st">&quot;bmatrix&quot;</span>))</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêà</mi><mn>3</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation*}
\mathbf{I}_3 =\begin{bmatrix} 
1 &amp; 0 &amp; 0 \\ 
0 &amp; 1 &amp; 0 \\ 
0 &amp; 0 &amp; 1 \\ 
\end{bmatrix}
\end{equation*}</annotation></semantics></math></p>
<ul>
<li>A row or column vector; the first argument to
<code>latexMatrix()</code> must be a <strong>matrix</strong>, so wrap an
R vector in <code>matrix()</code>, supplying <code>nrow=1</code> (or
<code>ncol = 1</code>):</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">latexMatrix</span>(<span class="fu">matrix</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">nrow=</span><span class="dv">1</span>), <span class="at">matrix=</span><span class="st">&quot;Bmatrix&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">Eqn</span>()</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>B</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>C</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>D</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\begin{Bmatrix} 
A &amp; B &amp; C &amp; D \\ 
\end{Bmatrix}
\end{equation*}</annotation></semantics></math></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">latexMatrix</span>(<span class="fu">matrix</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">ncol=</span><span class="dv">1</span>), <span class="at">matrix =</span> <span class="st">&quot;vmatrix&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">Eqn</span>()</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">‚à£</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>a</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>b</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>c</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">‚à£</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\begin{vmatrix} 
a \\ 
b \\ 
c \\ 
\end{vmatrix}
\end{equation*}</annotation></semantics></math></p>
<p>As the above examples illustrate, the matrix delimeters can be varied
using the <code>matrix</code> argument.</p>
<div id="the-svd" class="section level3">
<h3>The SVD</h3>
<p>As a more complicated example, here we write out the LaTeX equation
for the <a
href="https://en.wikipedia.org/wiki/Singular_value_decomposition">singular
value decomposition</a> (SVD) of a general
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \times p</annotation></semantics></math>
matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêó</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
using <code>Eqn()</code> and <code>latexMatrix()</code>. In Rmd markup,
<code>Eqn()</code> can be given an equation <strong>label</strong>
(using the <code>label</code> argument), which will both label and
number the equations.</p>
<p>Two calls to <code>Eqn()</code> produce separate equations in the
output. Both of these equations are numbered. (<code>Eqn()</code> uses
the LaTeX <code>equation</code> environment,
<code>\begin{equation} ... \end{equation}</code>, or
<code>equation*</code> if the equation does not include a
<code>label</code>). The two calls to <code>Eqn()</code> are rendered as
separate equations, center aligned.</p>
<!-- (In this example, using `echo = TRUE` gives output that -->
<!-- intersperses the code with the equation output for some reason.) -->
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">Eqn</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">mathbf{X} = </span><span class="sc">\\</span><span class="st">mathbf{U} </span><span class="sc">\\</span><span class="st">mathbf{</span><span class="sc">\\</span><span class="st">Lambda} </span><span class="sc">\\</span><span class="st">mathbf{V}^</span><span class="sc">\\</span><span class="st">top&quot;</span>, <span class="at">label=</span><span class="st">&#39;eq:svd&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">Eqn</span>(<span class="fu">latexMatrix</span>(<span class="st">&quot;u&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="at">lhs =</span> <span class="st">&#39;&#39;</span>),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="fu">latexMatrix</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">lambda&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="at">diag=</span><span class="cn">TRUE</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    <span class="fu">latexMatrix</span>(<span class="st">&quot;v&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;p&quot;</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>), <span class="at">label=</span><span class="st">&#39;eq:svdmats&#39;</span>)</span></code></pre></div>
<p>This produces the two numbered equations:<a href="#fn1"
class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>#</mi><mi>e</mi><mi>q</mi><mo>:</mo><mi>s</mi><mi>v</mi><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>ùêó</mi><mo>=</mo><mi>ùêî</mi><mi>ùö≤</mi><msup><mi>ùêï</mi><mi>‚ä§</mi></msup></mrow><annotation encoding="application/x-tex">\begin{equation}
(\#eq:svd)
\mathbf{X} = \mathbf{U} \mathbf{\Lambda} \mathbf{V}^\top
\end{equation}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>#</mi><mi>e</mi><mi>q</mi><mo>:</mo><mi>s</mi><mi>v</mi><mi>d</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>‚ã±</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mi>k</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mn>1</mn><mi>p</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mn>2</mn><mi>p</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mi>k</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mi>k</mi><mi>p</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>‚ä§</mi></msup></mrow><annotation encoding="application/x-tex">\begin{equation}
(\#eq:svdmats)
\begin{pmatrix} 
  u_{11} &amp; u_{12} &amp; \cdots &amp; u_{1k} \\ 
  u_{21} &amp; u_{22} &amp; \cdots &amp; u_{2k} \\ 
  \vdots &amp; \vdots &amp;        &amp; \vdots \\ 
  u_{n1} &amp; u_{n2} &amp; \cdots &amp; u_{nk} \\ 
\end{pmatrix}\begin{pmatrix} 
  \lambda_{1} &amp; 0           &amp; \cdots      &amp; 0           \\ 
  0           &amp; \lambda_{2} &amp; \cdots      &amp; 0           \\ 
  \vdots      &amp; \vdots      &amp; \ddots      &amp; \vdots      \\ 
  0           &amp; 0           &amp; \cdots      &amp; \lambda_{k} \\ 
\end{pmatrix}\begin{pmatrix} 
  v_{11} &amp; v_{12} &amp; \cdots &amp; v_{1p} \\ 
  v_{21} &amp; v_{22} &amp; \cdots &amp; v_{2p} \\ 
  \vdots &amp; \vdots &amp;        &amp; \vdots \\ 
  v_{k1} &amp; v_{k2} &amp; \cdots &amp; v_{kp} \\ 
\end{pmatrix}^\top
\end{equation}</annotation></semantics></math></p>
<p>The matrix names in Equation @ref(eq:svd) are printed in a
<strong>boldface</strong> math font (<code>\mathbf{}</code>), typically
used for matrices and vectors. Note that when using LaTeX code in R
expressions each backslash (<code>\</code>) must be doubled
(<code>\\</code>) in R because <code>\</code> is the escape
character.</p>
<p>Note that the first equation can be referenced because it was
labeled: ‚ÄúAs seen in Equation @ref(eq:svd) ‚Äù. References to equations
can entered in text using an inline call to <code>ref()</code>, e.g,
<code>`r ref("eq:svd")`</code> (In Quarto, equation labels must be of
the form <code>#eq-label</code> and equation references are of the form
<code>@eq-label</code>)</p>
</div>
<div id="systems-of-equations" class="section level3">
<h3>Systems of equations</h3>
<p>As another example, the chunk below shows a system of equations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêÄ</mi><mi>ùê±</mi><mo>=</mo><mi>ùêõ</mi></mrow><annotation encoding="application/x-tex">\mathbf{A} \mathbf{x} = \mathbf{b}</annotation></semantics></math>
written out using symbolic matrices.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">Eqn</span>(<span class="fu">latexMatrix</span>(<span class="st">&quot;a&quot;</span>, <span class="at">nrow =</span> <span class="st">&quot;m&quot;</span>, <span class="at">ncol=</span><span class="st">&quot;n&quot;</span>, <span class="at">matrix=</span><span class="st">&quot;bmatrix&quot;</span>),</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>    <span class="fu">latexMatrix</span>(<span class="st">&quot;x&quot;</span>, <span class="at">nrow =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ncol=</span><span class="dv">1</span>),</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="fu">Eqn_hspace</span>(<span class="at">mid=</span><span class="st">&#39;=&#39;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="fu">latexMatrix</span>(<span class="st">&quot;b&quot;</span>, <span class="at">nrow =</span> <span class="st">&quot;m&quot;</span>, <span class="at">ncol=</span><span class="dv">1</span>))</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>a</mi><mrow><mi>m</mi><mi>n</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mi>n</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mo>=</mo><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>b</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>b</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>b</mi><mi>m</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation*}
\begin{bmatrix} 
  a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\ 
  a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\ 
  \vdots &amp; \vdots &amp;        &amp; \vdots \\ 
  a_{m1} &amp; a_{m2} &amp; \cdots &amp; a_{mn} \\ 
\end{bmatrix}\begin{pmatrix} 
  x_{1} \\ 
  x_{2} \\ 
  \vdots \\ 
  x_{n} \\ 
\end{pmatrix}\quad=\quad\begin{pmatrix} 
  b_{1} \\ 
  b_{2} \\ 
  \vdots \\ 
  b_{m} \\ 
\end{pmatrix}
\end{equation*}</annotation></semantics></math></p>
<p>Extra symmetric white space is added via <code>Eqn_hspace()</code>,
which can also be used for standard spacing such as <code>\quad</code>
(default size), <code>\,</code>, <code>'1cm'</code> for
<code>\hspace{}</code>, etc.</p>
<p>Section <a href="#showEqn">showEqn</a> describes another way to
display systems of equations.</p>
</div>
<div id="aligned-environment" class="section level3">
<h3><code>aligned</code> environment</h3>
<p>You can also align separate equations relative to some symbol like an
<code>=</code> sign to show separate steps of re-expression, using the
option <code>Eqn(..., align=TRUE)</code>. Alignment points are marked by
<code>&amp;</code> in LaTeX.</p>
<p>Show the singular value decomposition again, but now as two separate
equations aligned after the <code>=</code> sign. Note the locations of
the <code>&amp;</code> operator for alignment, specified as the
left-hand side (<code>lhs</code>) of the second equation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">Eqn</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">mathbf{X} &amp; = </span><span class="sc">\\</span><span class="st">mathbf{U} </span><span class="sc">\\</span><span class="st">mathbf{</span><span class="sc">\\</span><span class="st">Lambda} </span><span class="sc">\\</span><span class="st">mathbf{V}^</span><span class="sc">\\</span><span class="st">top&quot;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>    <span class="fu">Eqn_newline</span>(),</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="st">&#39; &amp; =&#39;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="fu">latexMatrix</span>(<span class="st">&quot;u&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;k&quot;</span>),</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    <span class="fu">latexMatrix</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">lambda&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="at">diag=</span><span class="cn">TRUE</span>),</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    <span class="fu">latexMatrix</span>(<span class="st">&quot;v&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;p&quot;</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="at">align=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>ùêó</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>ùêî</mi><mi>ùö≤</mi><msup><mi>ùêï</mi><mi>‚ä§</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>u</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>‚ã±</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mi>k</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mn>1</mn><mi>p</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mn>2</mn><mi>p</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mi>k</mi><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>‚ãØ</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>v</mi><mrow><mi>k</mi><mi>p</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>‚ä§</mi></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\mathbf{X} &amp; = \mathbf{U} \mathbf{\Lambda} \mathbf{V}^\top \\ 
 &amp; =\begin{pmatrix} 
  u_{11} &amp; u_{12} &amp; \cdots &amp; u_{1k} \\ 
  u_{21} &amp; u_{22} &amp; \cdots &amp; u_{2k} \\ 
  \vdots &amp; \vdots &amp;        &amp; \vdots \\ 
  u_{n1} &amp; u_{n2} &amp; \cdots &amp; u_{nk} \\ 
\end{pmatrix}\begin{pmatrix} 
  \lambda_{1} &amp; 0           &amp; \cdots      &amp; 0           \\ 
  0           &amp; \lambda_{2} &amp; \cdots      &amp; 0           \\ 
  \vdots      &amp; \vdots      &amp; \ddots      &amp; \vdots      \\ 
  0           &amp; 0           &amp; \cdots      &amp; \lambda_{k} \\ 
\end{pmatrix}\begin{pmatrix} 
  v_{11} &amp; v_{12} &amp; \cdots &amp; v_{1p} \\ 
  v_{21} &amp; v_{22} &amp; \cdots &amp; v_{2p} \\ 
  \vdots &amp; \vdots &amp;        &amp; \vdots \\ 
  v_{k1} &amp; v_{k2} &amp; \cdots &amp; v_{kp} \\ 
\end{pmatrix}^\top
\end{align*}</annotation></semantics></math></p>
<p>Note that in this example, there are three calls to
<code>latexMatrix()</code>, wrapped inside <code>Eqn()</code>.
<code>Eqn_newline()</code> emits a newline (<code>\\</code>) between
equations.</p>
</div>
</div>
<div id="computing" class="section level2">
<h2>Computing with <code>"latexMatrix"</code> objects</h2>
<p>Objects returned by <code>latexMatrix()</code> that have
<strong>definite</strong> (i.e., numeric) dimensions‚Äî for example, a
3-by-2 matrix as opposed to an ‚Äún‚Äù-by-‚Äúm‚Äù matrix‚Äîmay be employed in a
variety of standard symbolic and numeric matrix computations. They
provide some reasonable means to compose meaningful matrix equations in
LaTeX far easier than doing this manually, matrix by matrix.</p>
<p>These computations include:</p>
<ul>
<li>the R arithmetic operators <code>+</code> (matrix addition),
<code>-</code> (matrix subtraction and negation), <code>*</code>
(product of a scalar and a matrix), and</li>
<li><code>%*%</code> (matrix multiplication), and the functions
<code>t()</code> (transpose), <code>determinant()</code>, and
<code>solve()</code> (matrix inverse).</li>
</ul>
<p>With the exception of <code>determinant()</code>, which (because it
is a scalar quantity) returns a character string with a LaTeX expression
for the determinant, these operators and functions return
<code>"latexMatrix"</code> objects, which can be printed, typeset, or
used in further computations. Additionally, in many instances a
<code>"latexMatrix"</code> object can be coerced to a numeric matrix by
<!-- `as.numeric()` or  --> <code>as.double()</code>. We illustrate
these computations in this section.</p>
<p>Consider, first, basic matrix arithmetic. Define some matrices:
<code>A</code> and <code>B</code> are numeric, but <code>C</code> and
<code>D</code> are symbolic, with elements
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">c_{ij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">d_{ij}</annotation></semantics></math></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>(A <span class="ot">&lt;-</span> <span class="fu">latexMatrix</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## \begin{pmatrix} 
##  1 &amp;  0 \\ 
## -3 &amp;  1 \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>(B <span class="ot">&lt;-</span> <span class="fu">latexMatrix</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## \begin{pmatrix} 
##  5 &amp; -1 \\ 
##  3 &amp;  4 \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>(C <span class="ot">&lt;-</span> <span class="fu">latexMatrix</span>(<span class="at">symbol=</span><span class="st">&quot;c&quot;</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## \begin{pmatrix} 
##   c_{11} &amp; c_{12} &amp; c_{13} \\ 
##   c_{21} &amp; c_{22} &amp; c_{23} \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>(D <span class="ot">&lt;-</span> <span class="fu">latexMatrix</span>(<span class="at">symbol=</span><span class="st">&quot;d&quot;</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## \begin{pmatrix} 
##   d_{11} &amp; d_{12} &amp; d_{13} \\ 
##   d_{21} &amp; d_{22} &amp; d_{23} \\ 
## \end{pmatrix}</code></pre>
<p>The usual arithmetic operations work for these
<code>"latexMatrix"</code> objects, and return LaTeX representations of
the result:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>A <span class="sc">+</span> B</span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## 1 + 5    &amp; 0 + (-1) \\ 
## (-3) + 3 &amp; 1 + 4    \\ 
## \end{pmatrix}</code></pre>
<p>Some other examples:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>A <span class="sc">-</span> B</span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## 1 - 5    &amp; 0 - (-1) \\ 
## (-3) - 3 &amp; 1 - 4    \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="sc">-</span>A            <span class="co"># unary minus</span></span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## - 1    &amp; - 0 \\ 
## - (-3) &amp; - 1 \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>A           <span class="co"># scalar multiplication</span></span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## 2 \cdot 1    &amp; 2 \cdot 0 \\ 
## 2 \cdot (-3) &amp; 2 \cdot 1 \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>C <span class="sc">+</span> D         <span class="co"># sum of symbolics</span></span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## c_{11} + d_{11} &amp; c_{12} + d_{12} &amp; c_{13} + d_{13} \\ 
## c_{21} + d_{21} &amp; c_{22} + d_{22} &amp; c_{23} + d_{23} \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="st">&quot;</span><span class="sc">\\</span><span class="st">pi&quot;</span> <span class="sc">*</span> C    <span class="co"># everything should be multiplied by pi</span></span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## \pi \cdot c_{11} &amp; \pi \cdot c_{12} &amp; \pi \cdot c_{13} \\ 
## \pi \cdot c_{21} &amp; \pi \cdot c_{22} &amp; \pi \cdot c_{23} \\ 
## \end{pmatrix}</code></pre>
<p>Typesetting the last result produces:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>œÄ</mi><mo>‚ãÖ</mo><msub><mi>c</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>œÄ</mi><mo>‚ãÖ</mo><msub><mi>c</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>œÄ</mi><mo>‚ãÖ</mo><msub><mi>c</mi><mn>13</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>œÄ</mi><mo>‚ãÖ</mo><msub><mi>c</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>œÄ</mi><mo>‚ãÖ</mo><msub><mi>c</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>œÄ</mi><mo>‚ãÖ</mo><msub><mi>c</mi><mn>23</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\begin{pmatrix}  
\pi \cdot c_{11} &amp; \pi \cdot c_{12} &amp; \pi \cdot c_{13} \\ 
\pi \cdot c_{21} &amp; \pi \cdot c_{22} &amp; \pi \cdot c_{23} \\ 
\end{pmatrix}
\end{equation*}</annotation></semantics></math></p>
<p>Some of these operations produce numeric results and so can be
coerced to numeric matrices; for example:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">as.numeric</span>(A <span class="sc">+</span> B)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    6   -1
## [2,]    0    5</code></pre>
<p>Using these tools, it is easy to typeset complete matrix equations,
giving multiple arguments to <code>Eqn()</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">Eqn</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">mathbf{A} + </span><span class="sc">\\</span><span class="st">mathbf{B} =&quot;</span>, A, <span class="st">&quot; + &quot;</span>, B, <span class="st">&quot; = &quot;</span>, A <span class="sc">+</span> B, <span class="st">&quot; = &quot;</span>, <span class="fu">as.double</span>(A <span class="sc">+</span> B))</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêÄ</mi><mo>+</mo><mi>ùêÅ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mn>3</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>5</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>3</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>4</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>+</mo><mn>5</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>3</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>+</mo><mn>4</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>6</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>5</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation*}
\mathbf{A} + \mathbf{B} =\begin{pmatrix} 
 1 &amp;  0 \\ 
-3 &amp;  1 \\ 
\end{pmatrix} + \begin{pmatrix} 
 5 &amp; -1 \\ 
 3 &amp;  4 \\ 
\end{pmatrix} = \begin{pmatrix}  
1 + 5    &amp; 0 + (-1) \\ 
(-3) + 3 &amp; 1 + 4    \\ 
\end{pmatrix} = \begin{pmatrix} 
 6 &amp; -1 \\ 
 0 &amp;  5 \\ 
\end{pmatrix}
\end{equation*}</annotation></semantics></math></p>
<p>If the elements of a matrix are valid R variable names, then it is
also possible to give these elements numeric values, as in</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>(M <span class="ot">&lt;-</span> <span class="fu">latexMatrix</span>(<span class="fu">matrix</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>], <span class="dv">3</span>, <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## \begin{pmatrix} 
## a &amp; d &amp; g \\ 
## b &amp; e &amp; h \\ 
## c &amp; f &amp; i \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">as.double</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>M, <span class="at">locals=</span><span class="fu">c</span>(<span class="at">a=</span><span class="dv">1</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">c=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">d=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">e=</span><span class="dv">7</span>, <span class="at">f=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">g=</span><span class="dv">0</span>, <span class="at">h=</span><span class="dv">4</span>, <span class="at">i=</span><span class="dv">6</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -2    8    0
## [2,]    0  -14   -8
## [3,]    4    2  -12</code></pre>
<div id="matrix-products-and-transpose" class="section level3">
<h3>Matrix products and transpose</h3>
<p>The product of two matrices is given by <code>%*%</code> for
<code>"latexMatrix"</code> objects.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>A <span class="sc">%*%</span> B</span></code></pre></div>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>‚ãÖ</mo><mn>5</mn><mo>+</mo><mn>0</mn><mo>‚ãÖ</mo><mn>3</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0</mn><mo>‚ãÖ</mo><mn>4</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mn>5</mn><mo>+</mo><mn>1</mn><mo>‚ãÖ</mo><mn>3</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>1</mn><mo>‚ãÖ</mo><mn>4</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{pmatrix}  
1 \cdot 5 + 0 \cdot 3    &amp; 1 \cdot (-1) + 0 \cdot 4    \\ 
(-3) \cdot 5 + 1 \cdot 3 &amp; (-3) \cdot (-1) + 1 \cdot 4 \\ 
\end{pmatrix}</annotation></semantics></math>
<p>To get the numeric result evaluated, use <code>as.double()</code> and
perform ordinary matrix multiplication:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">as.double</span>(A) <span class="sc">%*%</span> <span class="fu">as.double</span>(B) <span class="sc">|&gt;</span> <span class="fu">latexMatrix</span>()</span></code></pre></div>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>5</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mn>12</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>7</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{pmatrix} 
  5 &amp;  -1 \\ 
-12 &amp;   7 \\ 
\end{pmatrix}</annotation></semantics></math>
<p>The LaTeX symbol for multiplication is a centered dot,
<code>\\cdot</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>‚ãÖ</mo><annotation encoding="application/x-tex">\cdot</annotation></semantics></math>),
by default. This can be changed by changing
<code>options(latexMultSymbol)</code>, e.g, to use the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>√ó</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>
symbol instead, use:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">latexMultSymbol =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">times&quot;</span>)</span></code></pre></div>
<p>The transpose, <code>t()</code> of <code>"latexMatrix"</code> objects
is similarly straightforward. This directly transposes the matrix, as
opposed to superscript notation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ùêÉ</mi><mi>‚ä§</mi></msup><annotation encoding="application/x-tex">\mathbf{D}^\top</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ùêÉ</mi><mi>‚Ä≤</mi></msup><annotation encoding="application/x-tex">\mathbf{D}^\prime</annotation></semantics></math>
which is implicit.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>D</span></code></pre></div>
<pre><code>## \begin{pmatrix} 
##   d_{11} &amp; d_{12} &amp; d_{13} \\ 
##   d_{21} &amp; d_{22} &amp; d_{23} \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">t</span>(D)</span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## d_{11} &amp; d_{21} \\ 
## d_{12} &amp; d_{22} \\ 
## d_{13} &amp; d_{23} \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>M <span class="sc">%*%</span> <span class="fu">t</span>(D)</span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## a \cdot d_{11} + d \cdot d_{12} + g \cdot d_{13} &amp; a \cdot d_{21} + d \cdot d_{22} + g \cdot d_{23} \\ 
## b \cdot d_{11} + e \cdot d_{12} + h \cdot d_{13} &amp; b \cdot d_{21} + e \cdot d_{22} + h \cdot d_{23} \\ 
## c \cdot d_{11} + f \cdot d_{12} + i \cdot d_{13} &amp; c \cdot d_{21} + f \cdot d_{22} + i \cdot d_{23} \\ 
## \end{pmatrix}</code></pre>
<p>The matrix product in the previous example typesets as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>a</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>11</mn></msub><mo>+</mo><mi>d</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>12</mn></msub><mo>+</mo><mi>g</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>13</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>a</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>21</mn></msub><mo>+</mo><mi>d</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>22</mn></msub><mo>+</mo><mi>g</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>23</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>b</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>11</mn></msub><mo>+</mo><mi>e</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>12</mn></msub><mo>+</mo><mi>h</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>13</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>b</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>21</mn></msub><mo>+</mo><mi>e</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>22</mn></msub><mo>+</mo><mi>h</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>23</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>c</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>11</mn></msub><mo>+</mo><mi>f</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>12</mn></msub><mo>+</mo><mi>i</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>13</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>c</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>21</mn></msub><mo>+</mo><mi>f</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>22</mn></msub><mo>+</mo><mi>i</mi><mo>‚ãÖ</mo><msub><mi>d</mi><mn>23</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\begin{pmatrix}  
a \cdot d_{11} + d \cdot d_{12} + g \cdot d_{13} &amp; a \cdot d_{21} + d \cdot d_{22} + g \cdot d_{23} \\ 
b \cdot d_{11} + e \cdot d_{12} + h \cdot d_{13} &amp; b \cdot d_{21} + e \cdot d_{22} + h \cdot d_{23} \\ 
c \cdot d_{11} + f \cdot d_{12} + i \cdot d_{13} &amp; c \cdot d_{21} + f \cdot d_{22} + i \cdot d_{23} \\ 
\end{pmatrix}
\end{equation*}</annotation></semantics></math></p>
</div>
<div id="determnants-inverse" class="section level3">
<h3>Determnants &amp; inverse</h3>
<p>The determinant is computed <em>recursively</em> by finding the
<em>cofactors</em> of the first row of the matrix, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>det</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùêÄ</mi><mrow><mi>n</mi><mo>√ó</mo><mi>n</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>Œ£</mi><mi>j</mi><mi>n</mi></msubsup><mspace width="0.167em"></mspace><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mspace width="0.222em"></mspace><msub><mi>C</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\det(\mathbf{A}_{n \times n}) = \Sigma_j^n \, a_{ij}\: C_{ij}</annotation></semantics></math>
where the cofactors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">C_{ij}</annotation></semantics></math>
involve the determinants of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>√ó</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(n-1) \times (n-1)</annotation></semantics></math>
minors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêÄ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{A}_{ij}</annotation></semantics></math>.
(See the vignette <a
href="http://friendly.github.io/matlib/articles/det-ex2.html">Evaluation
of determinants</a> for explanation.)</p>
<p>The method is applicable to a matrix of any order, although beyond an
order-3 matrix, the resulting expression gets very long. A couple of
examples:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>## \begin{pmatrix} 
##  1 &amp;  0 \\ 
## -3 &amp;  1 \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">determinant</span>(A)</span></code></pre></div>
<pre><code>## [1] &quot;1 \\cdot 1 - 0 \\cdot (-3)&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>M</span></code></pre></div>
<pre><code>## \begin{pmatrix} 
## a &amp; d &amp; g \\ 
## b &amp; e &amp; h \\ 
## c &amp; f &amp; i \\ 
## \end{pmatrix}</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">determinant</span>(M)</span></code></pre></div>
<pre><code>## [1] &quot;a \\cdot (e \\cdot i - h \\cdot f) - d \\cdot (b \\cdot i - h \\cdot c) + g \\cdot (b \\cdot f - e \\cdot c)&quot;</code></pre>
<p>The determinant of a matrix is a single number.
<code>determinant()</code> returns the expression that computes it in
LaTeX notation, using <code>\\cdot</code> to represent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>‚ãÖ</mo><annotation encoding="application/x-tex">\cdot</annotation></semantics></math>
for multiplication.</p>
<p>Typesetting the output from the last command produces</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mo>‚ãÖ</mo><mi>i</mi><mo>‚àí</mo><mi>h</mi><mo>‚ãÖ</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>d</mi><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚ãÖ</mo><mi>i</mi><mo>‚àí</mo><mi>h</mi><mo>‚ãÖ</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>g</mi><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚ãÖ</mo><mi>f</mi><mo>‚àí</mo><mi>e</mi><mo>‚ãÖ</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation*}
a \cdot (e \cdot i - h \cdot f) - d \cdot (b \cdot i - h \cdot c) + g \cdot (b \cdot f - e \cdot c)
\end{equation*}</annotation></semantics></math></p>
<p>The inverse of a square matrix is computed from its determinant and
adjoint matrix; for example:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">solve</span>(A)</span></code></pre></div>
<pre><code>## \begin{pmatrix}  
## \dfrac{1}{1 \cdot 1 - 0 \cdot (-3)}     &amp; \dfrac{-0}{1 \cdot 1 - 0 \cdot (-3)} \\ 
## \dfrac{-(-3)}{1 \cdot 1 - 0 \cdot (-3)} &amp; \dfrac{1}{1 \cdot 1 - 0 \cdot (-3)}  \\ 
## \end{pmatrix}</code></pre>
<p>Specifying the argument <code>simplify = TRUE</code> to
<code>solve()</code> puts the inverse determinant before the adjoint
matrix and returns a latex expression rather than a
<code>"latexMatrix"</code> object; for example:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">solve</span>(M, <span class="at">simplify=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;\\frac{1}{a \\cdot (e \\cdot i - h \\cdot f) - d \\cdot (b \\cdot i - h \\cdot c) + g \\cdot (b \\cdot f - e \\cdot c)} \n\\begin{pmatrix}  \ne \\cdot i - h \\cdot f    &amp; -(d \\cdot i - g \\cdot f) &amp; d \\cdot h - g \\cdot e    \\\\ \n-(b \\cdot i - h \\cdot c) &amp; a \\cdot i - g \\cdot c    &amp; -(a \\cdot h - g \\cdot b) \\\\ \nb \\cdot f - e \\cdot c    &amp; -(a \\cdot f - d \\cdot c) &amp; a \\cdot e - d \\cdot b    \\\\ \n\\end{pmatrix}&quot;</code></pre>
<p>which typesets as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>a</mi><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mo>‚ãÖ</mo><mi>i</mi><mo>‚àí</mo><mi>h</mi><mo>‚ãÖ</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>d</mi><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚ãÖ</mo><mi>i</mi><mo>‚àí</mo><mi>h</mi><mo>‚ãÖ</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>g</mi><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚ãÖ</mo><mi>f</mi><mo>‚àí</mo><mi>e</mi><mo>‚ãÖ</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>e</mi><mo>‚ãÖ</mo><mi>i</mi><mo>‚àí</mo><mi>h</mi><mo>‚ãÖ</mo><mi>f</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo>‚ãÖ</mo><mi>i</mi><mo>‚àí</mo><mi>g</mi><mo>‚ãÖ</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>d</mi><mo>‚ãÖ</mo><mi>h</mi><mo>‚àí</mo><mi>g</mi><mo>‚ãÖ</mo><mi>e</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚ãÖ</mo><mi>i</mi><mo>‚àí</mo><mi>h</mi><mo>‚ãÖ</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>a</mi><mo>‚ãÖ</mo><mi>i</mi><mo>‚àí</mo><mi>g</mi><mo>‚ãÖ</mo><mi>c</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>‚ãÖ</mo><mi>h</mi><mo>‚àí</mo><mi>g</mi><mo>‚ãÖ</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>b</mi><mo>‚ãÖ</mo><mi>f</mi><mo>‚àí</mo><mi>e</mi><mo>‚ãÖ</mo><mi>c</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>‚ãÖ</mo><mi>f</mi><mo>‚àí</mo><mi>d</mi><mo>‚ãÖ</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>a</mi><mo>‚ãÖ</mo><mi>e</mi><mo>‚àí</mo><mi>d</mi><mo>‚ãÖ</mo><mi>b</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation*}
\frac{1}{a \cdot (e \cdot i - h \cdot f) - d \cdot (b \cdot i - h \cdot c) + g \cdot (b \cdot f - e \cdot c)} 
\begin{pmatrix}  
e \cdot i - h \cdot f    &amp; -(d \cdot i - g \cdot f) &amp; d \cdot h - g \cdot e    \\ 
-(b \cdot i - h \cdot c) &amp; a \cdot i - g \cdot c    &amp; -(a \cdot h - g \cdot b) \\ 
b \cdot f - e \cdot c    &amp; -(a \cdot f - d \cdot c) &amp; a \cdot e - d \cdot b    \\ 
\end{pmatrix}
\end{equation*}</annotation></semantics></math> We can also supply
values for the elements of the matrix to obtain a numeric inverse:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">fractions</span>(<span class="fu">as.double</span>(<span class="fu">solve</span>(M), </span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>                          <span class="at">locals=</span><span class="fu">c</span>(<span class="at">a=</span><span class="dv">1</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">c=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">d=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">e=</span><span class="dv">7</span>, <span class="at">f=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">g=</span><span class="dv">0</span>, <span class="at">h=</span><span class="dv">4</span>, <span class="at">i=</span><span class="dv">6</span>)))</span></code></pre></div>
<pre><code>##      [,1]  [,2]  [,3] 
## [1,] 23/39  4/13 -8/39
## [2,] -4/39  1/13 -2/39
## [3,]  7/39  3/26  7/78</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">fractions</span>(<span class="fu">det</span>(<span class="fu">as.double</span>(M, </span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>                              <span class="at">locals=</span><span class="fu">c</span>(<span class="at">a=</span><span class="dv">1</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">c=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">d=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">e=</span><span class="dv">7</span>, <span class="at">f=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">g=</span><span class="dv">0</span>, <span class="at">h=</span><span class="dv">4</span>, <span class="at">i=</span><span class="dv">6</span>))))</span></code></pre></div>
<pre><code>## [1] 78</code></pre>
</div>
<div id="linear-hypotheses" class="section level3">
<h3>Linear hypotheses</h3>
<p>As an example of the more general use of these functions, consider
the general linear hypothesis used to test hypotheses and contrasts in
linear models. We consider a multivariate regression model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêò</mi><mo>=</mo><mi>ùêó</mi><mi>ùêÅ</mi><mo>+</mo><mi>ùêÑ</mi></mrow><annotation encoding="application/x-tex">\mathbf{Y} = \mathbf{X} \mathbf{B} + \mathbf{E}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
regressors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùê±</mi><mn>0</mn></msub><mo>,</mo><msub><mi>ùê±</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>ùê±</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_0, \mathbf{x}_1, \dots, \mathbf{x}_q</annotation></semantics></math>
(including the constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùê±</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mathbf{x}_0</annotation></semantics></math>
for the intercept) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
responses,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùê≤</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ùê≤</mi><mn>2</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>ùê≤</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{y}_1, \mathbf{y}_2, \dots, \mathbf{y}_p</annotation></semantics></math>.</p>
<!-- [**Intercept* ignored here. Fix notation or description] -->
<p>Suppose we want to test the hypothesis that a subset of rows
(predictors) and/or columns (responses) simultaneously have null
effects. This can be expressed in the general linear test,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>‚Ñã</mi><mn>0</mn></msub><mo>:</mo><msub><mi>ùêÇ</mi><mrow><mi>h</mi><mo>√ó</mo><mi>q</mi></mrow></msub><mspace width="0.167em"></mspace><msub><mi>ùêÅ</mi><mrow><mi>q</mi><mo>√ó</mo><mi>p</mi></mrow></msub><mo>=</mo><msub><mn>ùüé</mn><mrow><mi>h</mi><mo>√ó</mo><mi>p</mi></mrow></msub><mspace width="0.222em"></mspace><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathcal{H}_0 : \mathbf{C}_{h \times q} \, \mathbf{B}_{q \times p} = \mathbf{0}_{h \times p} \: ,
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÇ</mi><annotation encoding="application/x-tex">\mathbf{C}</annotation></semantics></math>
is a full rank
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>‚â§</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">h \le q</annotation></semantics></math>
hypothesis matrix of constants, that selects subsets or linear
combinations (contrasts) of the coefficients in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÅ</mi><annotation encoding="application/x-tex">\mathbf{B}</annotation></semantics></math>
to be tested in a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
degree-of-freedom hypothesis.</p>
<p>For example, for a multivariate regression model with three responses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">y_1, y_2, y_3</annotation></semantics></math>
and three predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">x_1, x_2, x_3</annotation></semantics></math>,
the coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÅ</mi><annotation encoding="application/x-tex">\mathbf{B}</annotation></semantics></math>
are given by the <code>latexMatrix()</code> expression:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>(B <span class="ot">&lt;-</span> <span class="fu">latexMatrix</span>(<span class="st">&#39;</span><span class="sc">\\</span><span class="st">beta&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow=</span><span class="dv">4</span>, </span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>                 <span class="at">comma=</span><span class="cn">TRUE</span>, <span class="at">prefix.col =</span> <span class="st">&#39;y_&#39;</span>,</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>                 <span class="at">zero.based=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)))</span></code></pre></div>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>0</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>0</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>0</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>3</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>3</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>3</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{pmatrix} 
  \beta_{0,y_{1}} &amp; \beta_{0,y_{2}} &amp; \beta_{0,y_{3}} \\ 
  \beta_{1,y_{1}} &amp; \beta_{1,y_{2}} &amp; \beta_{1,y_{3}} \\ 
  \beta_{2,y_{1}} &amp; \beta_{2,y_{2}} &amp; \beta_{2,y_{3}} \\ 
  \beta_{3,y_{1}} &amp; \beta_{3,y_{2}} &amp; \beta_{3,y_{3}} \\ 
\end{pmatrix}</annotation></semantics></math>
<p>We can test the hypothesis that neither
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>
nor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>3</mn></msub><annotation encoding="application/x-tex">x_3</annotation></semantics></math>
contribute at all to the predicting the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>s
in terms of the hypothesis that the coefficients for the corresponding
rows of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÅ</mi><annotation encoding="application/x-tex">\mathbf{B}</annotation></semantics></math>
are zero. To do this, we specify a 2-row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÇ</mi><annotation encoding="application/x-tex">\mathbf{C}</annotation></semantics></math>
matrix that simply selects those rows:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>(C <span class="ot">&lt;-</span> <span class="fu">latexMatrix</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>                           <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>), </span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>                 <span class="at">matrix =</span> <span class="st">&quot;bmatrix&quot;</span>))</span></code></pre></div>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix} 
0 &amp; 1 &amp; 0 &amp; 0 \\ 
0 &amp; 0 &amp; 1 &amp; 0 \\ 
\end{bmatrix}</annotation></semantics></math>
<p>Then, the hypothesis to be tested can be expressed as follows, using
<code>Eqn()</code> to wrap a set of LaTeX expressions and calls to
<code>matlib</code> functions.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>B0 <span class="ot">&lt;-</span> <span class="fu">latexMatrix</span>(<span class="st">&#39;</span><span class="sc">\\</span><span class="st">beta&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">comma=</span><span class="cn">TRUE</span>, <span class="at">prefix.col =</span> <span class="st">&#39;y_&#39;</span>)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="fu">Eqn</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">mathcal{H}_0 : </span><span class="sc">\\</span><span class="st">mathbf{C} </span><span class="sc">\\</span><span class="st">mathbf{B} &amp; = &quot;</span>,</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>    C, B,</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>    <span class="fu">Eqn_newline</span>(), </span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>    <span class="st">&#39;&amp; =&#39;</span>,</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>    B0,</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>    <span class="st">&quot;= </span><span class="sc">\\</span><span class="st">mathbf{0}_{(2 </span><span class="sc">\\</span><span class="st">times 3)}&quot;</span>, </span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>    <span class="at">align=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>‚Ñã</mi><mn>0</mn></msub><mo>:</mo><mi>ùêÇ</mi><mi>ùêÅ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>0</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>0</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>0</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>3</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>3</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>3</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Œ≤</mi><mrow><mn>2</mn><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mn>ùüé</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>√ó</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\mathcal{H}_0 : \mathbf{C} \mathbf{B} &amp; = \begin{bmatrix} 
0 &amp; 1 &amp; 0 &amp; 0 \\ 
0 &amp; 0 &amp; 1 &amp; 0 \\ 
\end{bmatrix}\begin{pmatrix} 
  \beta_{0,y_{1}} &amp; \beta_{0,y_{2}} &amp; \beta_{0,y_{3}} \\ 
  \beta_{1,y_{1}} &amp; \beta_{1,y_{2}} &amp; \beta_{1,y_{3}} \\ 
  \beta_{2,y_{1}} &amp; \beta_{2,y_{2}} &amp; \beta_{2,y_{3}} \\ 
  \beta_{3,y_{1}} &amp; \beta_{3,y_{2}} &amp; \beta_{3,y_{3}} \\ 
\end{pmatrix} \\ 
&amp; =\begin{pmatrix} 
  \beta_{1,y_{1}} &amp; \beta_{1,y_{2}} &amp; \beta_{1,y_{3}} \\ 
  \beta_{2,y_{1}} &amp; \beta_{2,y_{2}} &amp; \beta_{2,y_{3}} \\ 
\end{pmatrix}= \mathbf{0}_{(2 \times 3)}
\end{align*}</annotation></semantics></math></p>
<p>In this example, note that the R objects <code>C</code>,
<code>B</code> and <code>B0</code> are the results of
<code>latexMatrix()</code> calls, which are character strings containing
LaTeX expressions.</p>
</div>
</div>
<div id="matrix2latex" class="section level2">
<h2>matrix2latex</h2>
<p>The <code>matrix2latex()</code> function can also generate symbolic
equations from numeric or character matrices. For numeric matrices, it
can round the values or show results as fractions.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">6</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">matrix2latex</span>(A, <span class="at">fractions =</span> <span class="cn">TRUE</span>, <span class="at">brackets =</span> <span class="st">&quot;b&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">Eqn</span>()</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mi>/</mi><mn>6</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>1</mn><mi>/</mi><mn>3</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>1</mn><mi>/</mi><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>2</mn><mi>/</mi><mn>3</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>5</mn><mi>/</mi><mn>6</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>7</mn><mi>/</mi><mn>6</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>4</mn><mi>/</mi><mn>3</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>3</mn><mi>/</mi><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>5</mn><mi>/</mi><mn>3</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>11</mn><mi>/</mi><mn>6</mn></mtd><mtd columnalign="left" style="text-align: left"><mn>2</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\left[
 \begin{array}{llll}
  1/6 &amp; 1/3 &amp; 1/2 &amp; 2/3 \\ 
  5/6 &amp; 1 &amp; 7/6 &amp; 4/3 \\ 
  3/2 &amp; 5/3 &amp; 11/6 &amp; 2 \\ 
  \end{array} \right]

\end{equation*}</annotation></semantics></math></p>
<p>Say we want to show the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>ùêÄ</mi><mo stretchy="false" form="prefix">|</mo><mi>ùêõ</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{A} | \mathbf{b}]</annotation></semantics></math>
involved in the system of equations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêÄ</mi><mi>ùê±</mi><mo>=</mo><mi>ùêõ</mi></mrow><annotation encoding="application/x-tex">\mathbf{A} \mathbf{x} = \mathbf{b}</annotation></semantics></math>.
Create these as a character matrix and vector:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">paste0</span>(<span class="st">&#39;a_&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>##      [,1]  [,2]  [,3] 
## [1,] &quot;a_1&quot; &quot;a_2&quot; &quot;a_3&quot;
## [2,] &quot;a_4&quot; &quot;a_5&quot; &quot;a_6&quot;
## [3,] &quot;a_7&quot; &quot;a_8&quot; &quot;a_9&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">beta_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## [1] &quot;\\beta_1&quot; &quot;\\beta_2&quot; &quot;\\beta_3&quot;</code></pre>
<p>Then use <code>matrix2latex()</code> on <code>cbind(A,b)</code> and
pipe the result of <code>matrix2latex()</code> to
<code>Eqn()</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">matrix2latex</span>(<span class="fu">cbind</span>(A,b)) <span class="sc">|&gt;</span> <span class="fu">Eqn</span>()</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>1</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>2</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>3</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Œ≤</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>4</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>5</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>6</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Œ≤</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>7</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>8</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>9</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Œ≤</mi><mn>3</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\left[
 \begin{array}{llll}
  a_1 &amp; a_2 &amp; a_3 &amp; \beta_1 \\ 
  a_4 &amp; a_5 &amp; a_6 &amp; \beta_2 \\ 
  a_7 &amp; a_8 &amp; a_9 &amp; \beta_3 \\ 
  \end{array} \right]

\end{equation*}</annotation></semantics></math></p>
<p>All the R tricks for creating and modifying matrices can be used in
this way.</p>
</div>
<div id="showEqn" class="section level2">
<h2>showEqn</h2>
<p><code>showEqn()</code> is designed to show a system of linear
equations,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ùêÄ</mi><mi>ùê±</mi></mrow><mo>=</mo><mi>ùêõ</mi></mrow><annotation encoding="application/x-tex">\mathbf{A x} = \mathbf{b}</annotation></semantics></math>,
but written out as a set of equations individually. With the option
<code>latex = TRUE</code> it writes these out in LaTeX form.</p>
<!-- `showEqn()` can also write LaTeX, but writes out the equations individually. -->
<!-- However, but the `array` environment needs to be included -->
<!-- inside `$$ ... $$` to be evaluated in a chunk, so this chunk is not evaluated (it causes a LaTeX error). -->
<p>Here, we create a character matrix containing the elements of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>√ó</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">3 \times 3</annotation></semantics></math>
matrix <code>A</code>, whose elements are of the form
<code>a_{ij}</code> and two character vectors, <code>b_i</code> and
<code>x_i</code>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">paste0</span>(<span class="st">&quot;a_{&quot;</span>, <span class="fu">outer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">FUN  =</span> paste0), <span class="st">&quot;}&quot;</span>), </span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>            <span class="at">nrow=</span><span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>##      [,1]     [,2]     [,3]    
## [1,] &quot;a_{11}&quot; &quot;a_{12}&quot; &quot;a_{13}&quot;
## [2,] &quot;a_{21}&quot; &quot;a_{22}&quot; &quot;a_{23}&quot;
## [3,] &quot;a_{31}&quot; &quot;a_{32}&quot; &quot;a_{33}&quot;</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;b_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><code>showEqn(..., latex = TRUE)</code> produces the three equations
in a single <code>\begin{array} ... \begin{array}</code>
environment.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">showEqn</span>(A, b, <span class="at">vars =</span> x, <span class="at">latex=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>If this line was run in an R console, it would produce:</p>
<pre><code>\begin{array}{lllllll}
a_{11} \cdot x_1 &amp;+&amp; a_{12} \cdot x_2 &amp;+&amp; a_{13} \cdot x_3  &amp;=&amp;  b_1 \\ 
a_{21} \cdot x_1 &amp;+&amp; a_{22} \cdot x_2 &amp;+&amp; a_{23} \cdot x_3  &amp;=&amp;  b_2 \\ 
a_{31} \cdot x_1 &amp;+&amp; a_{32} \cdot x_2 &amp;+&amp; a_{33} \cdot x_3  &amp;=&amp;  b_3 \\ 
\end{array}</code></pre>
<p>Evaluating the above code in an unnumbered LaTeX math environment via
<code>Eqn()</code> gives the desired result:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">showEqn</span>(A, b, <span class="at">vars =</span> x, <span class="at">latex=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">Eqn</span>()</span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>11</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>1</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>12</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>2</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>13</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>3</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>b</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>21</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>1</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>22</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>2</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>23</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>3</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>b</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>31</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>1</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>32</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>2</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>a</mi><mn>33</mn></msub><mo>‚ãÖ</mo><msub><mi>x</mi><mn>3</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>b</mi><mn>3</mn></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation*}
\begin{array}{lllllll}
a_{11} \cdot x_1 &amp;+&amp; a_{12} \cdot x_2 &amp;+&amp; a_{13} \cdot x_3  &amp;=&amp;  b_1 \\ 
a_{21} \cdot x_1 &amp;+&amp; a_{22} \cdot x_2 &amp;+&amp; a_{23} \cdot x_3  &amp;=&amp;  b_2 \\ 
a_{31} \cdot x_1 &amp;+&amp; a_{32} \cdot x_2 &amp;+&amp; a_{33} \cdot x_3  &amp;=&amp;  b_3 \\ 
\end{array}
\end{equation*}</annotation></semantics></math></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>At present equation numbers don‚Äôt work in vignettes
rendered as articles by <code>pkgdown</code>.<a href="#fnref1"
class="footnote-back">‚Ü©Ô∏é</a></p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox, Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>
