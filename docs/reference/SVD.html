<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Singular Value Decomposition of a Matrix — SVD • matlib</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Singular Value Decomposition of a Matrix — SVD"><meta name="description" content="Compute the singular-value decomposition of a matrix \(X\) either by Jacobi
rotations (the default) or from the eigenstructure of \(X'X\) using
Eigen. Both methods are iterative.
The result consists of two orthonormal matrices, \(U\), and \(V\) and the vector \(d\)
of singular values, such that \(X = U diag(d) V'\)."><meta property="og:description" content="Compute the singular-value decomposition of a matrix \(X\) either by Jacobi
rotations (the default) or from the eigenstructure of \(X'X\) using
Eigen. Both methods are iterative.
The result consists of two orthonormal matrices, \(U\), and \(V\) and the vector \(d\)
of singular values, such that \(X = U diag(d) V'\)."><meta property="og:image" content="http://friendly.github.io/matlib/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">matlib</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data-beta.html">Vector Spaces of Least Squares and Linear Equations</a></li>
    <li><a class="dropdown-item" href="../articles/det-ex1.html">Properties of determinants</a></li>
    <li><a class="dropdown-item" href="../articles/det-ex2.html">Evaluation of determinants</a></li>
    <li><a class="dropdown-item" href="../articles/eigen-ex1.html">Eigenvalues and Eigenvectors: Properties</a></li>
    <li><a class="dropdown-item" href="../articles/eigen-ex2.html">Eigenvalues: Spectral Decomposition</a></li>
    <li><a class="dropdown-item" href="../articles/ginv.html">Generalized inverse</a></li>
    <li><a class="dropdown-item" href="../articles/gramreg.html">Gram-Schmidt Orthogonalization and Regression</a></li>
    <li><a class="dropdown-item" href="../articles/inv-ex1.html">Inverse of a matrix</a></li>
    <li><a class="dropdown-item" href="../articles/inv-ex2.html">Matrix inversion by elementary row operations</a></li>
    <li><a class="dropdown-item" href="../articles/linear-equations.html">Solving Linear Equations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/matlib/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Singular Value Decomposition of a Matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/matlib/blob/HEAD/R/Eigen.R" class="external-link"><code>R/Eigen.R</code></a></small>
      <div class="d-none name"><code>SVD.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the singular-value decomposition of a matrix \(X\) either by Jacobi
rotations (the default) or from the eigenstructure of \(X'X\) using
<code><a href="Eigen.html">Eigen</a></code>. Both methods are iterative.
The result consists of two orthonormal matrices, \(U\), and \(V\) and the vector \(d\)
of singular values, such that \(X = U diag(d) V'\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SVD</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Jacobi"</span>, <span class="st">"eigen"</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a square symmetric matrix</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>either <code>"Jacobi"</code> (the default) or <code>"eigen"</code></p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>zero and convergence tolerance</p></dd>


<dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>maximum number of iterations</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list of three elements: <code>d</code>– singular values, <code>U</code>– left singular vectors, <code>V</code>– right singular vectors</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The default method is more numerically stable, but the eigenstructure method
is much simpler.
Singular values of zero are not retained in the solution.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></code>, the standard svd function</p>
<p><code><a href="Eigen.html">Eigen</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>John Fox and Georges Monette</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># nonsingular, symmetric</span></span></span>
<span class="r-in"><span><span class="va">C</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    2    5    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    3    6   10</span>
<span class="r-in"><span><span class="fu">SVD</span><span class="op">(</span><span class="va">C</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14.93303437  1.00000000  0.06696563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $U</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]          [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.2505248  4.308756e-14  0.9681102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5370109  8.320503e-01 -0.1389662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.8055164 -5.547002e-01 -0.2084492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]          [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.2505248  2.960306e-15  0.9681102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5370109  8.320503e-01 -0.1389662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.8055164 -5.547002e-01 -0.2084492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># least squares by the SVD</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"workers"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">workers</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Experience"</span>, <span class="st">"Skill"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Experience Skill</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abby    1          0     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Betty   1          5     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Charles 1          5     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Doreen  1         10     6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ethan   1         10    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Francie 1         15     7</span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">workers</span><span class="op">$</span><span class="va">Income</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20 35 40 30 50 50</span>
<span class="r-in"><span><span class="op">(</span><span class="va">svd</span> <span class="op">&lt;-</span> <span class="fu">SVD</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 66.864276  8.885751  1.100924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $U</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Experience       Skill            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abby    0.01366778  0.21621629  0.62512040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Betty   0.10046906  0.26924846  0.34867115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Charles 0.12007689  0.56866664 -0.06013463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Doreen  0.17419846  0.12266851  0.34475908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ethan   0.20034223  0.52189275 -0.20031530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Francie 0.24792785 -0.02391144  0.34084702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Georges 0.34780102  0.22873284 -0.20813943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Harry   0.40192259 -0.21726529  0.19675429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Isaac   0.50179576  0.03537900 -0.35223216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Juan    0.55591732 -0.41061914  0.05266156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]        [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.03984368  0.1475406  0.98825314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.89856830 -0.4378649  0.02914291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.43702116  0.8868518 -0.15002142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">VdU</span> <span class="op">&lt;-</span> <span class="va">svd</span><span class="op">$</span><span class="va">V</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">svd</span><span class="op">$</span><span class="va">d</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">svd</span><span class="op">$</span><span class="va">U</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">VdU</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 14.7808811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.1130069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  3.4053991</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Income</span> <span class="op">~</span> <span class="va">Experience</span> <span class="op">+</span> <span class="va">Skill</span>, data<span class="op">=</span><span class="va">workers</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  Experience       Skill </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  14.7808811   0.1130069   3.4053991 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox, Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

